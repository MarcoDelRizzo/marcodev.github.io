import{s as l,R as Ds,C as d,M as I,G as f,O as ze,T as D,N as Yt,g as S,a as Ve,b as v,W as js,c as Kt,d as N,A as rt,I as Es,e as $,f as Ts,B as Ue,h as A,U as kt,i as Y,j as K,V as Ms,k as De,l as E,m as L,P as Ge,n as ke,E as g,o as vi,p as yi,q as X,r as As,D as w,L as $s,t as Q,u as b,v as Ai,w as Ls,x as Fs,y as Bt,z as We,F as bt,H as je,S as Rs,J as Ns,K as Xt,Q as He,X as zs,Y as qe,Z as Vs,_ as Us,$ as Gs,a0 as xi,a1 as ks,a2 as vt,a3 as Ws,a4 as _e,a5 as $i,a6 as Hs,a7 as qs,a8 as wi,a9 as Ys,aa as Jt,ab as Li,ac as Ks,ad as Qs,ae as p,af as Zs,ag as Ye,ah as Fi,ai as Ri,aj as Ni,ak as Bs,al as O,am as Xs,an as Js,ao as zi}from"./needle-engine@4.11.6.js";import{n as R,P as tn,aA as T,x as yt,h as Ke,a7 as Vi,aR as Ee,V as u,i as en,M as sn,T as nn,t as rn,s as on,f as an,bj as ln,bD as hn,bM as cn,cU as pn,cV as dn,ap as _i,a2 as mn,cM as un,cx as fn,cC as gn,cW as bn,E as vn,aL as yn,cQ as Ui,bC as Gi,bk as xn}from"./three@0.169.11.js";import"./gltf-progressive.2ebc4b54.js";import{C as wn,a as _n,b as On}from"./three-examples.28755a6c.js";import"./three-mesh-ui.9f930f69.js";import"./three-quarks.0c231683.js";import"./postprocessing.bd3b3965.js";var Pn=Object.defineProperty,Cn=Object.getOwnPropertyDescriptor,ki=(s,t,e,n)=>{for(var i=n>1?void 0:n?Cn(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Pn(t,e,i),i};class Qe extends d{constructor(){super(...arguments),this.safeArea=new R(0,0)}update(){var i,r,o;const t=this.context.domWidth/this.safeArea.x,e=this.context.domHeight/this.safeArea.y,n=I.clamp(Math.min(t,e),0,1);(i=this.rectTransform)==null||i.scale.setScalar(n),(o=(r=this.rectTransform)==null?void 0:r.shadowComponent)==null||o.scale.setScalar(n)}}ki([l(Ds)],Qe.prototype,"rectTransform",2);ki([l(R)],Qe.prototype,"safeArea",2);var Sn=Object.defineProperty,In=Object.getOwnPropertyDescriptor,Ze=(s,t,e,n)=>{for(var i=n>1?void 0:n?In(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Sn(t,e,i),i};class te extends d{constructor(){super(...arguments),this.createMenuButton=!1,this.teleportVRPlayer=!1,this.ignoreYInVR=!1,this.menuButton=null}get orbitalCamera(){return this._orbitalCamera??(this._orbitalCamera=f.findObjectOfType(ze)),this._orbitalCamera}awake(){this.createMenuButton&&this.addButton()}addButton(){var n;this.menuButton&&this.removeButton();const t=((n=this.gameObject.getComponentInChildren(D))==null?void 0:n.text)??this.gameObject.name,e=document.createElement("button");this.menuButton=e,e.innerText=t.replace("_"," "),e.setAttribute("priority","40"),e.addEventListener("click",()=>this.use()),this.context.menu.appendChild(e)}removeButton(){this.menuButton&&(this.menuButton.remove(),this.menuButton=null)}use(){var e,n;(e=this.orbitalCamera)==null||e.setCameraTargetPosition(this.worldPosition);const t=(n=Yt.active)==null?void 0:n.rig;if(this.teleportVRPlayer&&this.context.isInVR&&t){const i=S(this.worldPosition);this.ignoreYInVR&&(i.y=t.gameObject.worldPosition.y),t.gameObject.worldPosition=i}}}Ze([l()],te.prototype,"createMenuButton",2);Ze([l()],te.prototype,"teleportVRPlayer",2);Ze([l()],te.prototype,"ignoreYInVR",2);class Dn extends d{constructor(){super(...arguments),this.cam=null}onEnable(){this.cam=this.gameObject.getComponent(Ve),this.cam||(console.warn("CameraLayer requires a Camera component"),this.enabled=!1)}onAfterRender(){if(!this.cam)return;const t=this.scene.background;this.context.renderer.autoClearColor=!1,this.cam.cam instanceof tn&&this.context.updateAspect(this.cam.cam),this.scene.background=null,this.context.renderer.render(this.scene,this.cam.cam),this.scene.background=t}}var jn=Object.defineProperty,En=Object.getOwnPropertyDescriptor,ee=(s,t,e,n)=>{for(var i=n>1?void 0:n?En(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&jn(t,e,i),i};class _t extends d{constructor(){super(...arguments),this.strength=10,this.maxInstances=10,this._instances=[],this._index=-1,this._onPointerDown=t=>{t.button===0&&this.throwBall(t.space.worldPosition,t.space.worldForward)}}start(){this.prefab&&f.setActive(this.prefab,!1),this.webXR??(this.webXR=f.findObjectOfType(js))}onEnable(){this.context.input.addEventListener("pointerdown",this._onPointerDown)}onDisable(){this.context.input.removeEventListener("pointerdown",this._onPointerDown)}throwBall(t,e){var o,a;if(!this.prefab)return;if(this._instances.length<this.maxInstances){const h=new Es;h.position=t;const c=f.instantiate(this.prefab,h);if(!c)return;this._instances.push(c)}const n=++this._index,i=this._instances[n%this._instances.length];if(!i)return;Kt(i,t),f.setActive(i,!0),(o=this.audioSource)==null||o.stop(),(a=this.audioSource)==null||a.play();const r=f.getComponent(i,N);r&&(e.multiplyScalar(this.strength),r.resetForcesAndTorques(),r.resetVelocities(),r==null||r.applyImpulse(e))}}ee([v(T)],_t.prototype,"prefab",2);ee([v(rt)],_t.prototype,"audioSource",2);ee([v()],_t.prototype,"strength",2);ee([v()],_t.prototype,"maxInstances",2);var Tn=Object.defineProperty,Mn=Object.getOwnPropertyDescriptor,Wi=(s,t,e,n)=>{for(var i=n>1?void 0:n?Mn(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Tn(t,e,i),i};class Be extends d{constructor(){super(...arguments),this.applyOnStart=!0,this.randomMetallicRoughness=!0}start(){{const t=this.gameObject.getComponent($);if(!t)return;for(let e=0;e<t.sharedMaterials.length;e++)t.sharedMaterials[e]=t.sharedMaterials[e].clone()}this.applyOnStart&&this.applyRandomColor()}applyRandomColor(){const t=this.gameObject.getComponent($);if(!t){console.warn("Can not change color: No renderer on "+this.name);return}for(let e=0;e<t.sharedMaterials.length;e++){const n=t.sharedMaterials[e];n.color=new yt(Math.random(),Math.random(),Math.random()),this.randomMetallicRoughness&&n instanceof Ke&&(n.metalness=Math.random(),n.roughness=Math.random()*Math.random()),n.needsUpdate=!0,Ts.markDirty(this.gameObject)}}}Wi([v()],Be.prototype,"applyOnStart",2);Wi([v()],Be.prototype,"randomMetallicRoughness",2);class An extends d{constructor(){super(...arguments),this.renderer=null,this.collisionCount=0}start(){if(this.renderer=this.gameObject.getComponent($),!!this.renderer){this._startColor||(this._startColor=[]);for(let t=0;t<this.renderer.sharedMaterials.length;t++)this.renderer.sharedMaterials[t]=this.renderer.sharedMaterials[t].clone(),this._startColor[t]=this.renderer.sharedMaterials[t].color.clone()}}onCollisionEnter(t){if(this.renderer){this.collisionCount+=1;for(let e=0;e<this.renderer.sharedMaterials.length;e++)this.renderer.sharedMaterials[e].color.setRGB(Math.random(),Math.random(),Math.random())}}onCollisionExit(t){if(!(!this.renderer||!this._startColor)&&(this.collisionCount-=1,this.collisionCount===0))for(let e=0;e<this.renderer.sharedMaterials.length;e++)this.renderer.sharedMaterials[e].color.copy(this._startColor[e])}}var $n=Object.defineProperty,Ln=Object.getOwnPropertyDescriptor,Fn=(s,t,e,n)=>{for(var i=n>1?void 0:n?Ln(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&$n(t,e,i),i};class Hi extends d{update(){this.myMaterial&&(this.myMaterial._Speed*=1+this.context.time.deltaTime,this.myMaterial._Speed>1&&(this.myMaterial._Speed=5e-4),this.context.time.frame%30===0&&console.log(this.myMaterial._Speed))}}Fn([l(Vi)],Hi.prototype,"myMaterial",2);var Rn=Object.defineProperty,Nn=Object.getOwnPropertyDescriptor,zn=(s,t,e,n)=>{for(var i=n>1?void 0:n?Nn(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Rn(t,e,i),i};class qi extends d{click(){var t,e;(e=(t=this.buttonToClick)==null?void 0:t.onClick)==null||e.invoke()}}zn([l(Ue)],qi.prototype,"buttonToClick",2);var Vn=Object.defineProperty,Un=Object.getOwnPropertyDescriptor,Gn=(s,t,e,n)=>{for(var i=n>1?void 0:n?Un(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Vn(t,e,i),i};class Yi extends d{constructor(){super(...arguments),this.objectToMatrix=new Map}start(){var t;(t=this.target)==null||t.traverse(e=>{this.objectToMatrix.set(e,e.matrix.clone())})}onPointerClick(t){for(const[e,n]of this.objectToMatrix)e.matrix.copy(n),e.matrix.decompose(e.position,e.quaternion,e.scale),e.matrixWorldNeedsUpdate=!0}createBehaviours(t,e,n){if(e.uuid!==this.gameObject.uuid||!this.target)return;const i=A.parallel();for(const[h,c]of this.objectToMatrix){const m=kt.createEmpty();m.matrix=c,h.parent&&m.matrix.premultiply(h.parent.matrixWorld),n.document.add(m),i.addAction(A.transformAction(h,m,0,"absolute","none"))}const r=new Y("click_to_reset",K.tapTrigger(this.gameObject),i);t.addBehavior(r);const o=kt.createEmpty();o.name="InputTarget",o.displayName=void 0,o.type="RealityKitComponent",o.onSerialize=h=>{h.appendLine("bool allowsDirectInput = 1"),h.appendLine("bool allowsIndirectInput = 1"),h.appendLine('uniform token info:id = "RealityKit.InputTarget"')},e.add(o);const a=kt.createEmpty();a.name="HoverEffect",a.displayName=void 0,a.type="RealityKitComponent",a.onSerialize=h=>{h.appendLine('uniform token info:id = "RealityKit.HoverEffect"')},e.add(a)}}Gn([l(f)],Yi.prototype,"target",2);var kn=Object.defineProperty,Wn=Object.getOwnPropertyDescriptor,Xe=(s,t,e,n)=>{for(var i=n>1?void 0:n?Wn(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&kn(t,e,i),i};class ie extends d{constructor(){super(...arguments),this.apertureMultiplier=2,this.focalLength=.001,this.focusDistanceCutoff=25,this.volume=null,this.dofEffect=void 0}onEnable(){var t,e,n;this.volume=f.findObjectOfType(Ms),this.dofEffect=(n=(e=(t=this.volume)==null?void 0:t.sharedProfile)==null?void 0:e.components)==null?void 0:n.find(i=>i.typeName==="DepthOfField"),this.orbit=f.findObjectOfType(ze)}onBeforeRender(){var e;if(!((e=this.orbit)!=null&&e.controls))return;const t=this.orbit.controls.target.distanceTo(De(this.orbit.gameObject));if(this.dofEffect){this.dofEffect.focusDistance.value=t,this.dofEffect.focalLength.value=this.focalLength;let n=I.inverseLerp(0,this.focusDistanceCutoff,t);n=I.clamp01(n),this.dofEffect.aperture.value=I.lerp(this.apertureMultiplier,32,n);const i=this.focusDistanceCutoff;t>i&&this.dofEffect.active?this.dofEffect.active=!1:t<i&&!this.dofEffect.active&&(this.dofEffect.active=!0)}}}Xe([l()],ie.prototype,"apertureMultiplier",2);Xe([l()],ie.prototype,"focalLength",2);Xe([l()],ie.prototype,"focusDistanceCutoff",2);class Hn extends d{constructor(){super(...arguments),this._previousEnvironmentTexture=null}onEnable(){this._previousEnvironmentTexture=this.context.scene.environment,this.context.scene.environment=null}onDisable(){this.context.scene.environment=this._previousEnvironmentTexture}}var qn=Object.defineProperty,Yn=Object.getOwnPropertyDescriptor,Kn=(s,t,e,n)=>{for(var i=n>1?void 0:n?Yn(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&qn(t,e,i),i};const Qn=E("sample_debugParticlesOnClick");class Ki extends d{constructor(){super(...arguments),this.particleSystems=[]}update(){if(!this.context.isInVR&&this.context.input.getPointerClicked(0)){const t=this.context.physics.raycast();t.length>0&&this.spawnParticlesAt(t[0].point)}}onUpdateXR(t){t.xr.controllers.forEach(e=>{var n,i;if(((n=e.getButton("primary"))==null?void 0:n.isDown)===!0){const r=(i=this.context.physics.raycastFromRay(e.ray))==null?void 0:i.at(0);r&&this.spawnParticlesAt(r.point)}})}spawnParticlesAt(t){Kt(this.gameObject,t),Qn&&L.DrawWireSphere(t,.5,16711680,1);for(const e of this.particleSystems)e&&(f.setActive(e.gameObject,!0),e.play())}}Kn([v(Ge)],Ki.prototype,"particleSystems",2);var Zn=Object.defineProperty,Bn=Object.getOwnPropertyDescriptor,Xn=(s,t,e,n)=>{for(var i=n>1?void 0:n?Bn(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Zn(t,e,i),i};class Qi extends d{constructor(){super(...arguments),this.parameters=[]}awake(){var t=!1;this.parameters.forEach(e=>{E(e)||(ke(e,""),t=!0)}),t&&window.location.reload()}}Xn([l()],Qi.prototype,"parameters",2);var Jn=Object.defineProperty,tr=Object.getOwnPropertyDescriptor,Zi=(s,t,e,n)=>{for(var i=n>1?void 0:n?tr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Jn(t,e,i),i};class Je extends d{constructor(){super(...arguments),this.htmlSelector="button.some-button",this.onClick=new g,this.onClicked=()=>{this.onClick.invoke()}}onEnable(){this.element=document.querySelector(this.htmlSelector),this.element?this.element.addEventListener("click",this.onClicked):console.warn(`Could not find element with selector "${this.htmlSelector}"`)}onDisable(){this.element&&this.element.removeEventListener("click",this.onClicked)}}Zi([v()],Je.prototype,"htmlSelector",2);Zi([l(g)],Je.prototype,"onClick",2);var er=Object.defineProperty,ir=Object.getOwnPropertyDescriptor,Bi=(s,t,e,n)=>{for(var i=n>1?void 0:n?ir(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&er(t,e,i),i};class ti extends d{constructor(){super(...arguments),this.createdElements=[]}onEnable(){var t;if(!(!this.methods||!this.names))for(let e=0;e<this.methods.length;e++){const n=this.methods[e];let i="Button";e<((t=this.names)==null?void 0:t.length)&&(i=this.names[e]);const r=document.createElement("button");r.innerHTML=i,r.onclick=()=>{n.invoke()},this.context.menu.appendChild(r),this.createdElements.push(r)}}onDisable(){for(const t of this.createdElements)t.remove()}reloadPageInSeconds(t){setTimeout(()=>{location.reload()},t*1e3)}}Bi([l(g)],ti.prototype,"methods",2);Bi([l()],ti.prototype,"names",2);var sr=Object.defineProperty,nr=Object.getOwnPropertyDescriptor,se=(s,t,e,n)=>{for(var i=n>1?void 0:n?nr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&sr(t,e,i),i};class Ot extends d{constructor(){super(...arguments),this.url="https://www.youtube.com/embed/puWNRrG4MCg",this.pixelsPerUnit=500,this.borderRadius=50,this.animator=null,this.rotate90=new Ee().setFromAxisAngle(new u(0,1,0),Math.PI)}start(){const t=E("url");t&&(this.url=t);const e=document.createElement("div");e.innerHTML='<iframe width="1000" height="1000" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; xr-spatial-tracking; xr" allowfullscreen></iframe>',e.style.zIndex="10000",e.style.position="absolute",e.style.pointerEvents="initial";const n=e.querySelector("iframe");n.addEventListener("load",()=>{setTimeout(()=>{var h;console.log("Automatically opening iframe"),(h=this.animator)==null||h.SetBool("Open",!0)},1e3)}),n.src=this.url;let i=1e3;const r=Math.round(this.gameObject.scale.x*this.pixelsPerUnit),o=Math.round(this.gameObject.scale.y*this.pixelsPerUnit);i=Math.max(r,o),n.width=r+"px",n.height=o+"px",e.style.position="absolute",this.borderRadius>0&&(e.style.borderRadius=this.borderRadius+"px"),e.style.pointerEvents="initial",document.body.append(e),this.cssRenderer=new wn,this.cssRenderer.domElement.style.pointerEvents="none",this.cssRenderer.domElement.style.position="absolute",this.cssRenderer.domElement.style.top="0px",document.body.append(this.cssRenderer.domElement),this.cssScene=new en;const a=new _n(e);a.scale.setScalar(Math.max(this.gameObject.scale.x,this.gameObject.scale.y)/i),Kt(a,De(this.gameObject)),vi(a,yi(this.gameObject)),a.quaternion.multiply(this.rotate90),this.cssScene.add(a),this.cssObj=a,this.context.post_render_callbacks.push(this.onPostRender.bind(this))}onPostRender(){if(!this.cssObj||!this.cssRenderer||!this.cssScene)return;Kt(this.cssObj,De(this.gameObject)),vi(this.cssObj,yi(this.gameObject)),this.cssObj.quaternion.multiply(this.rotate90);const t=this.context.mainCamera,e=this.gameObject;var n=t.position.clone().sub(this.gameObject.position).normalize(),i=e.getWorldDirection(new u);const r=n.dot(i);this.cssObj.visible=r<.15;const o=this.cssRenderer.getSize();(o.width!==this.context.domWidth||o.height!==this.context.domHeight)&&this.cssRenderer.setSize(this.context.domWidth,this.context.domHeight),this.cssRenderer.render(this.cssScene,this.context.mainCamera)}}se([v()],Ot.prototype,"url",2);se([v()],Ot.prototype,"pixelsPerUnit",2);se([v()],Ot.prototype,"borderRadius",2);se([v(X)],Ot.prototype,"animator",2);class rr extends d{constructor(){super(...arguments),this._ui=null,this._incubationsHint=null,this._components=[]}onEnable(){var r;(r=this._ui)==null||r.remove(),this._components=f.findObjectsOfType(As);const t=document.createElement("div");t.style.cssText=`
            font-family: 'Roboto flex', Ariel;
            position: absolute;
            top: .5rem;
            left: 1rem;
            color: rgba(255, 255, 255, .7);
            line-height: 1.2em;
            display: flex;
            gap: 1em;
            max-width: 400px;
        `,this.context.domElement.appendChild(t),this._ui=t;const e=document.createElement("div");t.appendChild(e);const n=document.createElement("h2");n.innerText="Sample Images",e.appendChild(n);const i=document.createElement("p");i.innerHTML=`Download the image and print it or you can also open the image in your browser
        <br><strong>Then enter AR and scan it with your camera.</strong>
        <br>Visit our <a target="_blank" href="https://docs.needle.tools/image-tracking">ImageTracking documentation</a> for more information.
        `,i.style.userSelect="all",i.style.backdropFilter="blur(5px)",i.style.borderRadius=".5rem",i.style.padding=".5rem 0",e.appendChild(i),i.querySelectorAll("a").forEach(o=>{o.style.color="rgba(255, 255, 255, .8)",o.style.textDecoration="underline"});for(const o of this._components)this.createDownloadImageUI(o,t)}onDisable(){var t;(t=this._ui)==null||t.remove()}update(){var t;this.context.isInAR?(t=this._ui)==null||t.remove():this._ui&&!this._ui.parentNode&&this.context.domElement.appendChild(this._ui)}onUpdateXR(t){if(t.xr.frame&&!("getImageTrackingResults"in t.xr.frame)&&!this._incubationsHint&&this._ui&&w.isAndroidDevice()){const e=document.createElement("p");e.style.cssText=`
                    background: rgba(255, 100, 100, .7);
                    border-radius: .5rem;
                    padding: .4rem;
                `,e.innerText="WebXR ImageTracking is not enabled. Go to chrome://flags/#webxr-incubations and enable #webxr-incubations",this._ui.append(e),this._incubationsHint=e}}createDownloadImageUI(t,e){if(t.trackedImages)for(const n of t.trackedImages){if(!n.image)continue;const i=document.createElement("a");i.href=n.image,i.target="_blank",e.appendChild(i);const r=document.createElement("img");r.src=n.image,r.style.cssText=`
                flex: .5;
                min-width: 100px;
                max-width: 160px;
                height: auto;
                aspect-ratio: 1.3;
                object-fit: cover;
                background: rgba(0,0,0,0.5);
                border-radius: .5rem;
                border: 1px solid rgba(255,255,255,.9);
                box-shadow: 0 0 10px rgba(0,0,0,.2);
                margin-right: 1rem;
            `,i.appendChild(r)}}}var or=Object.defineProperty,ar=Object.getOwnPropertyDescriptor,Xi=(s,t,e,n)=>{for(var i=n>1?void 0:n?ar(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&or(t,e,i),i};class ei extends d{constructor(){super(...arguments),this.tempVec1=new u,this.tempVec2=new u}update(){if(!this.lodGroup||!this.text)return;const t=this.context.mainCamera;t.getWorldPosition(this.tempVec1),this.gameObject.getWorldPosition(this.tempVec2);const e=this.tempVec1.distanceTo(this.tempVec2)/t.zoom,n=this.lodGroup._lodsHandler;let i=null;n==null||n.forEach(r=>{var c,m;const o=r.levels[r.getCurrentLevel()],a=r.levels.at(r.getCurrentLevel()+1);let h=null;if(o.object instanceof sn){const j=o.object.geometry.attributes,H=Math.floor(((c=j.position)==null?void 0:c.count)||0);h=`Triangles: ${Math.floor((((m=j.index)==null?void 0:m.count)||H)/3)}, Vertices: ${H}`}o.object.name.replace(/_/g,""),o.object.name.includes("Cull")||(i="",h&&(i+=`${h}
`),a==null||a.hysteresis,i+=`${o.distance.toFixed(1)} / ${e.toFixed(1)}`,a&&(i+=` / ${(a.distance-a.distance*a.hysteresis).toFixed(1)}`))}),i||(i="culled"),this.text.text=i}}Xi([l($s)],ei.prototype,"lodGroup",2);Xi([l(D)],ei.prototype,"text",2);var lr=Object.defineProperty,hr=Object.getOwnPropertyDescriptor,ii=(s,t,e,n)=>{for(var i=n>1?void 0:n?hr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&lr(t,e,i),i};class Te extends d{onColorChanged(){typeof this.color=="number"&&(this.color=new yt(this.color)),this.setColorToMaterials()}onPointerClick(t){const e=new yt(Math.random(),Math.random(),Math.random());this.color=e}onEnable(){b("<strong>Click an object</strong> to change the color. Open this window in another browser tab/window to see the networking in action..."),this.setColorToMaterials()}setColorToMaterials(){var e;const t=this.gameObject.getComponent($);if(t)for(let n=0;n<t.sharedMaterials.length;n++){const i=(e=t.sharedMaterials[n])==null?void 0:e.clone();t.sharedMaterials[n]=i,i&&"color"in i&&(i.color=this.color)}else console.warn("No renderer found",this.gameObject)}}ii([Q(Te.prototype.onColorChanged),l(yt)],Te.prototype,"color",2);class Me extends d{constructor(){super(...arguments),this.myArray=[],this.updateArray=()=>{const t=new Date().toLocaleTimeString();console.log("> Update array",t),this.myArray.length>10&&(console.log("Clearing array because we have reached 10 entries"),this.myArray.length=0),this.myArray.push(t),this.myArray=this.myArray,b(`<strong>> Send</strong> "${t}", ${this.myArray.length} elements`)}}onArrayChanged(){console.log("< Received array",this.myArray[this.myArray.length-1],this.myArray),b(`<strong>< Received</strong> "${this.myArray[this.myArray.length-1]}", we now have ${this.myArray.length} elements`)}start(){b("Open this window in another browser tab/window to see the networking in action..."),setInterval(this.updateArray,4e3)}}ii([Q(Me.prototype.onArrayChanged)],Me.prototype,"myArray",2);class cr{constructor(){this.name="",this.age=0}}class Ae extends d{constructor(){super(...arguments),this.myObject=new cr,this.updateObject=()=>{this.myObject.name=this.context.connection.connectionId,this.myObject.age+=1,this.myObject=this.myObject,console.log("> Updated",this.myObject),b('<strong>> Sent</strong> "'+this.myObject.name+'" is '+this.myObject.age+" years old")}}onObjectChanged(){console.log("< Received object",this.myObject),b(`<strong>< Received</strong> "${this.myObject.name}" is ${this.myObject.age} years old`)}awake(){b("Open this window in another browser tab/window to see the networking in action..."),setInterval(this.updateObject,5e3)}}ii([Q(Ae.prototype.onObjectChanged)],Ae.prototype,"myObject",2);var pr=Object.defineProperty,dr=Object.getOwnPropertyDescriptor,Ji=(s,t,e,n)=>{for(var i=n>1?void 0:n?dr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&pr(t,e,i),i};class si extends d{constructor(){super(...arguments),this.clampFrameRate=!0,this._clampFrameRate=!1,this.maxFrameRate=72,this._maxFrameRate=-1024}update(){if(this._clampFrameRate!==this.clampFrameRate||this._maxFrameRate!==this.maxFrameRate){const t=this.clampFrameRate?this.maxFrameRate:void 0;this.context.targetFrameRate=t,this._clampFrameRate=this.clampFrameRate,this._maxFrameRate=this.maxFrameRate}}setTarget(t){this.maxFrameRate=t,this.clampFrameRate=!0}setClamping(t){this.clampFrameRate=t}}Ji([l()],si.prototype,"clampFrameRate",2);Ji([l()],si.prototype,"maxFrameRate",2);var mr=Object.defineProperty,ur=Object.getOwnPropertyDescriptor,ne=(s,t,e,n)=>{for(var i=n>1?void 0:n?ur(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&mr(t,e,i),i};class Pt extends d{constructor(){super(...arguments),this.width=1024,this.height=1024,this.prefab=null}takePhoto(){const t=Ls({type:"texture",camera:this.camera,width:this.width,height:this.height});this.prefab&&t instanceof nn&&this.prefab.instantiate(this.scene).then(e=>{if(!e)return;setTimeout(()=>{e.destroy()},2e3),e==null||e.position.set(0,3,0),e==null||e.getOrAddComponent(Fs);const n=e==null?void 0:e.getComponentInChildren(N);n&&(n.teleport(this.gameObject.worldPosition.add({x:0,y:.5,z:0})),n.setAngularVelocity(Math.random()-.5,Math.random()-.5,Math.random()*2-1),n.applyImpulse(this.gameObject.worldForward.add({x:0,y:2,z:0}).normalize().multiplyScalar(.01)));const i=e==null?void 0:e.getComponentInChildren($);if(i){const r=i.sharedMaterial.clone()||new Ke;r&&"map"in r&&(r.map=t,r.side=rn),i.sharedMaterial=r}})}}ne([l(Ve)],Pt.prototype,"camera",2);ne([l()],Pt.prototype,"width",2);ne([l()],Pt.prototype,"height",2);ne([l(Ai)],Pt.prototype,"prefab",2);var fr=Object.defineProperty,gr=Object.getOwnPropertyDescriptor,Z=(s,t,e,n)=>{for(var i=n>1?void 0:n?gr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&fr(t,e,i),i};class Ct extends d{constructor(){super(...arguments),this.logEvents=!1}onCollisionEnter(t){var e;this.logEvents&&console.log("ENTER",t),(e=this.onEnter)==null||e.invoke(t)}onCollisionStay(t){var e;this.logEvents&&console.log("STAY",t),(e=this.onStay)==null||e.invoke(t)}onCollisionExit(t){var e;this.logEvents&&console.log("EXIT",t),(e=this.onExit)==null||e.invoke(t)}}Z([v(g)],Ct.prototype,"onEnter",2);Z([v(g)],Ct.prototype,"onStay",2);Z([v(g)],Ct.prototype,"onExit",2);Z([v()],Ct.prototype,"logEvents",2);class St extends d{onTriggerEnter(t){var e,n;this.triggerObjects&&this.triggerObjects.length>0&&!((e=this.triggerObjects)!=null&&e.includes(t.gameObject))||(n=this.onEnter)==null||n.invoke()}onTriggerStay(t){var e,n;this.triggerObjects&&this.triggerObjects.length>0&&!((e=this.triggerObjects)!=null&&e.includes(t.gameObject))||(n=this.onStay)==null||n.invoke()}onTriggerExit(t){var e,n;this.triggerObjects&&this.triggerObjects.length>0&&!((e=this.triggerObjects)!=null&&e.includes(t.gameObject))||(n=this.onExit)==null||n.invoke()}}Z([v(f)],St.prototype,"triggerObjects",2);Z([v(g)],St.prototype,"onEnter",2);Z([v(g)],St.prototype,"onStay",2);Z([v(g)],St.prototype,"onExit",2);var br=Object.defineProperty,vr=Object.getOwnPropertyDescriptor,yr=(s,t,e,n)=>{for(var i=n>1?void 0:n?vr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&br(t,e,i),i};class ts extends d{constructor(){super(...arguments),this._lastTriggerTime=0}onTriggerEnter(t){this.context.time.time-this._lastTriggerTime<.3||(this._lastTriggerTime=this.context.time.time,this.animation&&this.animation.play(0,{loop:!1}))}onTriggerExit(){}}yr([v(Bt)],ts.prototype,"animation",2);var xr=Object.defineProperty,wr=Object.getOwnPropertyDescriptor,_r=(s,t,e,n)=>{for(var i=n>1?void 0:n?wr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&xr(t,e,i),i};class es extends d{onTriggerEnter(){var t,e;(t=this.animation)!=null&&t.isPlaying||(e=this.animation)==null||e.play(0,{loop:!1})}}_r([v(Bt)],es.prototype,"animation",2);var Or=Object.defineProperty,Pr=Object.getOwnPropertyDescriptor,Cr=(s,t,e,n)=>{for(var i=n>1?void 0:n?Pr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Or(t,e,i),i};class is extends d{onCollisionEnter(){var t,e;(t=this.audioSource)==null||t.stop(),(e=this.audioSource)==null||e.play()}}Cr([v(rt)],is.prototype,"audioSource",2);class Sr extends d{onEnable(){const t=f.findObjectOfType(We);t==null||t.addEventListener("before-export",()=>{this.resetAnimations()})}onEnterXR(t){this.resetAnimations()}resetAnimations(){console.warn("Resetting animations and audio for XR export.");const t=f.findObjectsOfType(Bt);for(const n of t)n.actions.forEach(i=>{i.reset(),i.time=0,i.play()});const e=f.findObjectsOfType(rt);for(const n of e)n.stop(),n.play()}}var Ir=Object.defineProperty,Dr=Object.getOwnPropertyDescriptor,ss=(s,t,e,n)=>{for(var i=n>1?void 0:n?Dr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Ir(t,e,i),i};class ni extends d{constructor(){super(...arguments),this.referenceSize=512,this.updateSize=()=>{if(this.content){if(this.referenceSize<=0)return console.error("ResponsiveContent: Base width must be greater than 0.");const t=this.context.domWidth/this.referenceSize;this.content.scale.set(t,t,t)}else bt()&&console.warn("ResponsiveContent: No content object set.")}}onEnable(){window.addEventListener("resize",this.updateSize),this.updateSize()}onDisable(){window.removeEventListener("resize",this.updateSize)}}ss([l(T)],ni.prototype,"content",2);ss([l()],ni.prototype,"referenceSize",2);var jr=Object.defineProperty,Er=Object.getOwnPropertyDescriptor,ri=(s,t,e,n)=>{for(var i=n>1?void 0:n?Er(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&jr(t,e,i),i};class ns extends d{async sceneOpened(){var t;(t=this.animator)==null||t.setBool("SceneOpen",!0),this._htmlElement=this._getHtmlElement(),this.context.domElement.appendChild(this._htmlElement)}async sceneClosing(){var t,e;await je(1e3),(t=this.animator)==null||t.setBool("SceneOpen",!1),await je(1e3),(e=this._htmlElement)==null||e.remove()}_getHtmlElement(){if(!this._htmlElement){this._htmlElement=document.createElement("div"),this._htmlElement.style.cssText=`
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
                // backdrop-filter: blur(10px);
            `;const t=document.createElement("img");t.src="https://engine.needle.tools/branding/needle-logo.png",this._htmlElement.appendChild(t)}return this._htmlElement}}ri([l(X)],ns.prototype,"animator",2);class oi extends d{sceneOpened(){var t;return bt()&&console.log("Scene opened",this.name),(t=this.opened)==null||t.invoke(),Promise.resolve()}sceneClosing(){var t;return bt()&&console.log("Scene closing",this.name),(t=this.closing)==null||t.invoke(),Promise.resolve()}}ri([l(g)],oi.prototype,"opened",2);ri([l(g)],oi.prototype,"closing",2);class Tr extends d{next(){var t;this.switcher??(this.switcher=this.get()),console.log(this.switcher),(t=this.switcher)==null||t.selectNext()}previous(){var t;this.switcher??(this.switcher=this.get()),(t=this.switcher)==null||t.selectPrev()}get(){return f.findObjectOfType(Rs)}}class Mr extends d{awake(){const t=this.gameObject.getComponent($);if(t!=null&&t.sharedMaterials)for(const e of t.sharedMaterials)e&&(e.side=on)}}var Ar=Object.defineProperty,$r=Object.getOwnPropertyDescriptor,Lr=(s,t,e,n)=>{for(var i=n>1?void 0:n?$r(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Ar(t,e,i),i};class rs extends d{constructor(){super(...arguments),this.text=""}start(){b(this.text)}}Lr([l()],rs.prototype,"text",2);var Fr=Object.defineProperty,Rr=Object.getOwnPropertyDescriptor,Nr=(s,t,e,n)=>{for(var i=n>1?void 0:n?Rr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Fr(t,e,i),i};const zr=E("testleaderboard");class $e extends d{constructor(){super(...arguments),this._ready=!1}get ready(){return this._ready}onEnable(){this.context.connection.beginListen(Ns.JoinedRoom,async()=>{await je(100),this.context.connection.tryGetState(this.guid)||(this.data={scores:[]}),this._ready=!0}),zr?(console.log("Enabled test leaderboard, adding random scores"),setInterval(()=>{this.insertScore("Player",Math.floor(Math.random()*1e3))},2e3)):bt()&&b("You can add ?testleaderboard to the url to test the leaderboard")}insertScore(t,e){if(!this._ready){console.warn("Cannot insert score, data not received yet");return}const n=10,i=this.data.scores;for(;i.length>=n;){this.sortScores();const r=i.pop();if(r.score>e){console.log(`Score ${e} is lower than ${r==null?void 0:r.score} (lowest score), ignoring`),i.push(r);return}}console.log("Inserting score",t,e),i.push({name:t,score:e}),this.sortScores(),this.data=this.data}sortScores(){this.data.scores.sort((t,e)=>e.score-t.score)}onDataChanged(t){if(console.warn("Data changed!",t,this.data.scores),this.data.scores.length>0){const e=this.data.scores[0];b("HIGHSCORE - "+e.name+": "+e.score)}this.dispatchEvent(new CustomEvent("changed",{detail:this.data}))}}Nr([Q($e.prototype.onDataChanged)],$e.prototype,"data",2);var Vr=Object.defineProperty,Ur=Object.getOwnPropertyDescriptor,Gr=(s,t,e,n)=>{for(var i=n>1?void 0:n?Ur(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Vr(t,e,i),i};class os extends d{start(){this.updateStartPosition();const t=f.findObjectOfType(We);t&&t.addEventListener("before-export",()=>{this.resetToStart()})}updateStartPosition(){this.gameObject.updateMatrix(),this.startPosition=this.gameObject.position.clone(),this.startMatrix=this.gameObject.matrix.clone()}resetToStart(){if(!this.startPosition)return;const t=f.getComponent(this.gameObject,N);t==null||t.teleport(this.startPosition)}}class as extends os{start(){super.start(),this.worldCollider||console.warn("Missing collider to reset",this)}onTriggerExit(t){t===this.worldCollider&&this.resetToStart()}createBehaviours(t,e,n){if(e.uuid!==this.gameObject.uuid||!this.startPosition||!this.startMatrix)return;const i=kt.createEmpty();this.gameObject.parent?i.matrix=this.gameObject.parent.matrixWorld.clone().multiply(this.startMatrix):i.matrix=this.startMatrix,n.document.add(i);const r=new Y("_reset_"+this.name+"_afterTime",K.sceneStartTrigger(),A.sequence(A.waitAction(Math.random()*4+1),A.sequence(A.transformAction(this.gameObject,i,0,"absolute","none"),A.waitAction(5)).makeLooping())).makeExclusive(!0);t.addBehavior(r)}}Gr([v(Xt)],as.prototype,"worldCollider",2);var kr=Object.defineProperty,Wr=Object.getOwnPropertyDescriptor,Hr=(s,t,e,n)=>{for(var i=n>1?void 0:n?Wr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&kr(t,e,i),i};class ls extends d{constructor(){super(...arguments),this.roomId="",this.playerCount=0}update(){const t=this.context.connection;let e=!1;t.currentRoomName&&t.currentRoomName!==this.roomId&&(this.roomId=t.currentRoomName,e=!0),t.usersInRoom().length!==this.playerCount&&(this.playerCount=t.usersInRoom().length,e=!0),e&&this.connectionLabel&&(this.connectionLabel.text=`Room: ${this.roomId}
Users: ${this.playerCount}
Your id: ${t.connectionId}`)}}Hr([l(D)],ls.prototype,"connectionLabel",2);var qr=Object.defineProperty,Yr=Object.getOwnPropertyDescriptor,Kr=(s,t,e,n)=>{for(var i=n>1?void 0:n?Yr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&qr(t,e,i),i};class hs extends d{constructor(){super(...arguments),this.interval=1e3,this.max=100,this.spawned=0}awake(){if(!this.object){console.warn("TimedSpawn: no object to spawn"),b("TimedSpawn: no object to spawn",He.Warn);return}f.setActive(this.object,!1),this.startCoroutine(this.spawn())}*spawn(){if(this.object)for(;this.spawned<this.max;){const t=f.instantiate(this.object);f.setActive(t,!0),this.spawned+=1,yield zs(this.interval/1e3)}}}Kr([v(f)],hs.prototype,"object",2);var Qr=Object.defineProperty,Zr=Object.getOwnPropertyDescriptor,Br=(s,t,e,n)=>{for(var i=n>1?void 0:n?Zr(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Qr(t,e,i),i};class cs extends d{constructor(){super(...arguments),this.onlyMobile=!1}awake(){if(this.onlyMobile&&!qe())return;const t=this.gameObject.getComponent(Vs);t&&(t.position="top")}}Br([l()],cs.prototype,"onlyMobile",2);class Xr extends d{constructor(){super(...arguments),this._video=null}async onEnable(){this._video??(this._video=document.createElement("video")),this._video.style.cssText=`
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            object-fit: cover;
        `,this.context.domElement.shadowRoot.appendChild(this._video);const t=await navigator.mediaDevices.getUserMedia({video:!0});!t||!this.enabled||(this._video.srcObject=t,this._video.play())}onDisable(){var t,e;(t=this._video)==null||t.pause(),(e=this._video)==null||e.remove()}}var Jr=Object.defineProperty,to=Object.getOwnPropertyDescriptor,re=(s,t,e,n)=>{for(var i=n>1?void 0:n?to(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Jr(t,e,i),i};class It extends d{constructor(){super(...arguments),this.interval=3,this.resetPosition=!0,this.resetRotation=!1,this.resetVelocity=!1}start(){const t=this.gameObject.position.clone(),e=this.gameObject.rotation.clone(),n=this.gameObject.getComponent(N),i=this.context.time.frame;setInterval(()=>{this.resetPosition&&this.gameObject.position.copy(t),this.resetRotation&&this.gameObject.rotation.copy(e),n&&this.resetVelocity&&this.context.time.frame!==i&&n.resetVelocities()},this.interval*1e3)}}re([l()],It.prototype,"interval",2);re([l()],It.prototype,"resetPosition",2);re([l()],It.prototype,"resetRotation",2);re([l()],It.prototype,"resetVelocity",2);class eo extends d{constructor(){super(...arguments),this.toggleRendererOnly=!1}start(){setInterval(()=>{if(b('This is a sample for showing how to <a href="https://engine.needle.tools/docs/scripting.html#component-architecture" target="_blank">toggle visibility of a GameObject</a>'),this.toggleRendererOnly){const t=this.gameObject.getComponent($);t&&(t.enabled=!t.enabled)}else this.gameObject.visible=!this.gameObject.visible},1e3)}}var io=Object.defineProperty,so=Object.getOwnPropertyDescriptor,no=(s,t,e,n)=>{for(var i=n>1?void 0:n?so(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&io(t,e,i),i};class ps extends d{awake(){this.material&&(this.material.wireframe=!0)}}no([l(Vi)],ps.prototype,"material",2);var ro=Object.defineProperty,oo=Object.getOwnPropertyDescriptor,ds=(s,t,e,n)=>{for(var i=n>1?void 0:n?oo(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&ro(t,e,i),i};class ai extends d{constructor(){super(...arguments),this.onSessionStart=new g,this.onSessionEnd=new g}onEnterXR(t){this.onWebXRStarted()}onExitXR(t){this.onWebXREnded()}onWebXRStarted(){this.onSessionStart.invoke()}onWebXREnded(){this.onSessionEnd.invoke()}}ds([l(g)],ai.prototype,"onSessionStart",2);ds([l(g)],ai.prototype,"onSessionEnd",2);const Vt=E("debugbodytracking");class ao extends d{constructor(){super(...arguments),this.jointPositions=new Map,this.size=new u(.01,.01,.01),this.hasWarnedForName=new Set}onEnable(){Vt&&console.log(Oi.join(`
`))}onBeforeXR(t,e){e.optionalFeatures=e.optionalFeatures||[],e.optionalFeatures.includes("body-tracking")||e.optionalFeatures.push("body-tracking")}onUpdateXR(t){const e=t.xr.frame;if(!e)return;const n=t.xr.rig.gameObject,i=this.context.renderer.xr.getReferenceSpace();if(e.session&&"body"in e&&i){const r=e.body;if(!r)return;r.forEach(o=>{const a=e.getPose(o,i);if(!a)return;const h=a.transform.position,c=S();c.copy(h),c.x*=-1,c.z*=-1,n.localToWorld(c);const m=o.jointName;this.jointPositions.has(m)||this.jointPositions.set(m,new u),this.jointPositions.get(m).copy(c),Vt&&L.DrawWireBox(c,this.size,16711680,void 0,!1);const j=S();j.copy(h),j.x*=-1,n.localToWorld(j);const H=o.jointName+"-flipped";this.jointPositions.has(H)||this.jointPositions.set(H,new u),this.jointPositions.get(H).copy(j),Vt&&L.DrawWireBox(j,this.size,65280,void 0,!1);const et=Oi.indexOf(m);Vt&&L.DrawLabel(j,et.toString(),.015,void 0,16777215,85),et<0&&(this.hasWarnedForName.has(m)||(this.hasWarnedForName.add(m),console.warn("Wrong name: "+m+" -> "+et+". Please report a bug.")))});for(const o of lo){const a=this.jointPositions.get(o.from),h=this.jointPositions.get(o.to);if(a&&h){L.DrawLine(a,h,16776960,void 0,!1);const c=this.jointPositions.get(o.from+"-flipped"),m=this.jointPositions.get(o.to+"-flipped");c&&m&&L.DrawLine(c,m,65535,void 0,!1)}}}}}var ms=(s=>(s[s.root=0]="root",s[s.hips=1]="hips",s[s["spine-lower"]=2]="spine-lower",s[s["spine-middle"]=3]="spine-middle",s[s["spine-upper"]=4]="spine-upper",s[s.chest=5]="chest",s[s.neck=6]="neck",s[s.head=7]="head",s[s["left-shoulder"]=8]="left-shoulder",s[s["left-scapula"]=9]="left-scapula",s[s["left-arm-upper"]=10]="left-arm-upper",s[s["left-arm-lower"]=11]="left-arm-lower",s[s["left-hand-wrist-twist"]=12]="left-hand-wrist-twist",s[s["right-shoulder"]=13]="right-shoulder",s[s["right-scapula"]=14]="right-scapula",s[s["right-arm-upper"]=15]="right-arm-upper",s[s["right-arm-lower"]=16]="right-arm-lower",s[s["right-hand-wrist-twist"]=17]="right-hand-wrist-twist",s[s["left-hand-palm"]=18]="left-hand-palm",s[s["left-hand-wrist"]=19]="left-hand-wrist",s[s["left-hand-thumb-metacarpal"]=20]="left-hand-thumb-metacarpal",s[s["left-hand-thumb-phalanx-proximal"]=21]="left-hand-thumb-phalanx-proximal",s[s["left-hand-thumb-phalanx-distal"]=22]="left-hand-thumb-phalanx-distal",s[s["left-hand-thumb-tip"]=23]="left-hand-thumb-tip",s[s["left-hand-index-metacarpal"]=24]="left-hand-index-metacarpal",s[s["left-hand-index-phalanx-proximal"]=25]="left-hand-index-phalanx-proximal",s[s["left-hand-index-phalanx-intermediate"]=26]="left-hand-index-phalanx-intermediate",s[s["left-hand-index-phalanx-distal"]=27]="left-hand-index-phalanx-distal",s[s["left-hand-index-tip"]=28]="left-hand-index-tip",s[s["left-hand-middle-phalanx-metacarpal"]=29]="left-hand-middle-phalanx-metacarpal",s[s["left-hand-middle-phalanx-proximal"]=30]="left-hand-middle-phalanx-proximal",s[s["left-hand-middle-phalanx-intermediate"]=31]="left-hand-middle-phalanx-intermediate",s[s["left-hand-middle-phalanx-distal"]=32]="left-hand-middle-phalanx-distal",s[s["left-hand-middle-tip"]=33]="left-hand-middle-tip",s[s["left-hand-ring-metacarpal"]=34]="left-hand-ring-metacarpal",s[s["left-hand-ring-phalanx-proximal"]=35]="left-hand-ring-phalanx-proximal",s[s["left-hand-ring-phalanx-intermediate"]=36]="left-hand-ring-phalanx-intermediate",s[s["left-hand-ring-phalanx-distal"]=37]="left-hand-ring-phalanx-distal",s[s["left-hand-ring-tip"]=38]="left-hand-ring-tip",s[s["left-hand-little-metacarpal"]=39]="left-hand-little-metacarpal",s[s["left-hand-little-phalanx-proximal"]=40]="left-hand-little-phalanx-proximal",s[s["left-hand-little-phalanx-intermediate"]=41]="left-hand-little-phalanx-intermediate",s[s["left-hand-little-phalanx-distal"]=42]="left-hand-little-phalanx-distal",s[s["left-hand-little-tip"]=43]="left-hand-little-tip",s[s["right-hand-palm"]=44]="right-hand-palm",s[s["right-hand-wrist"]=45]="right-hand-wrist",s[s["right-hand-thumb-metacarpal"]=46]="right-hand-thumb-metacarpal",s[s["right-hand-thumb-phalanx-proximal"]=47]="right-hand-thumb-phalanx-proximal",s[s["right-hand-thumb-phalanx-distal"]=48]="right-hand-thumb-phalanx-distal",s[s["right-hand-thumb-tip"]=49]="right-hand-thumb-tip",s[s["right-hand-index-metacarpal"]=50]="right-hand-index-metacarpal",s[s["right-hand-index-phalanx-proximal"]=51]="right-hand-index-phalanx-proximal",s[s["right-hand-index-phalanx-intermediate"]=52]="right-hand-index-phalanx-intermediate",s[s["right-hand-index-phalanx-distal"]=53]="right-hand-index-phalanx-distal",s[s["right-hand-index-tip"]=54]="right-hand-index-tip",s[s["right-hand-middle-metacarpal"]=55]="right-hand-middle-metacarpal",s[s["right-hand-middle-phalanx-proximal"]=56]="right-hand-middle-phalanx-proximal",s[s["right-hand-middle-phalanx-intermediate"]=57]="right-hand-middle-phalanx-intermediate",s[s["right-hand-middle-phalanx-distal"]=58]="right-hand-middle-phalanx-distal",s[s["right-hand-middle-tip"]=59]="right-hand-middle-tip",s[s["right-hand-ring-metacarpal"]=60]="right-hand-ring-metacarpal",s[s["right-hand-ring-phalanx-proximal"]=61]="right-hand-ring-phalanx-proximal",s[s["right-hand-ring-phalanx-intermediate"]=62]="right-hand-ring-phalanx-intermediate",s[s["right-hand-ring-phalanx-distal"]=63]="right-hand-ring-phalanx-distal",s[s["right-hand-ring-tip"]=64]="right-hand-ring-tip",s[s["right-hand-little-metacarpal"]=65]="right-hand-little-metacarpal",s[s["right-hand-little-phalanx-proximal"]=66]="right-hand-little-phalanx-proximal",s[s["right-hand-little-phalanx-intermediate"]=67]="right-hand-little-phalanx-intermediate",s[s["right-hand-little-phalanx-distal"]=68]="right-hand-little-phalanx-distal",s[s["right-hand-little-tip"]=69]="right-hand-little-tip",s[s["left-upper-leg"]=70]="left-upper-leg",s[s["left-lower-leg"]=71]="left-lower-leg",s[s["left-foot-ankle-twist"]=72]="left-foot-ankle-twist",s[s["left-foot-ankle"]=73]="left-foot-ankle",s[s["left-foot-subtalar"]=74]="left-foot-subtalar",s[s["left-foot-transverse"]=75]="left-foot-transverse",s[s["left-foot-ball"]=76]="left-foot-ball",s[s["right-upper-leg"]=77]="right-upper-leg",s[s["right-lower-leg"]=78]="right-lower-leg",s[s["right-foot-ankle-twist"]=79]="right-foot-ankle-twist",s[s["right-foot-ankle"]=80]="right-foot-ankle",s[s["right-foot-subtalar"]=81]="right-foot-subtalar",s[s["right-foot-transverse"]=82]="right-foot-transverse",s[s["right-foot-ball"]=83]="right-foot-ball",s))(ms||{});const Oi=Object.values(ms),lo=[{from:"hips",to:"spine-lower"},{from:"spine-lower",to:"spine-middle"},{from:"spine-middle",to:"spine-upper"},{from:"spine-upper",to:"chest"},{from:"chest",to:"neck"},{from:"neck",to:"head"},{from:"chest",to:"left-shoulder"},{from:"left-shoulder",to:"left-scapula"},{from:"left-scapula",to:"left-arm-upper"},{from:"left-arm-upper",to:"left-arm-lower"},{from:"left-arm-lower",to:"left-hand-wrist-twist"},{from:"left-hand-wrist-twist",to:"left-hand-wrist"},{from:"left-hand-wrist",to:"left-hand-palm"},{from:"left-hand-wrist",to:"left-hand-thumb-metacarpal"},{from:"left-hand-thumb-metacarpal",to:"left-hand-thumb-phalanx-proximal"},{from:"left-hand-thumb-phalanx-proximal",to:"left-hand-thumb-phalanx-distal"},{from:"left-hand-thumb-phalanx-distal",to:"left-hand-thumb-tip"},{from:"left-hand-wrist",to:"left-hand-index-metacarpal"},{from:"left-hand-index-metacarpal",to:"left-hand-index-phalanx-proximal"},{from:"left-hand-index-phalanx-proximal",to:"left-hand-index-phalanx-intermediate"},{from:"left-hand-index-phalanx-intermediate",to:"left-hand-index-phalanx-distal"},{from:"left-hand-index-phalanx-distal",to:"left-hand-index-tip"},{from:"left-hand-wrist",to:"left-hand-middle-phalanx-metacarpal"},{from:"left-hand-middle-phalanx-metacarpal",to:"left-hand-middle-phalanx-proximal"},{from:"left-hand-middle-phalanx-proximal",to:"left-hand-middle-phalanx-intermediate"},{from:"left-hand-middle-phalanx-intermediate",to:"left-hand-middle-phalanx-distal"},{from:"left-hand-middle-phalanx-distal",to:"left-hand-middle-tip"},{from:"left-hand-wrist",to:"left-hand-ring-metacarpal"},{from:"left-hand-ring-metacarpal",to:"left-hand-ring-phalanx-proximal"},{from:"left-hand-ring-phalanx-proximal",to:"left-hand-ring-phalanx-intermediate"},{from:"left-hand-ring-phalanx-intermediate",to:"left-hand-ring-phalanx-distal"},{from:"left-hand-ring-phalanx-distal",to:"left-hand-ring-tip"},{from:"left-hand-wrist",to:"left-hand-little-metacarpal"},{from:"left-hand-little-metacarpal",to:"left-hand-little-phalanx-proximal"},{from:"left-hand-little-phalanx-proximal",to:"left-hand-little-phalanx-intermediate"},{from:"left-hand-little-phalanx-intermediate",to:"left-hand-little-phalanx-distal"},{from:"left-hand-little-phalanx-distal",to:"left-hand-little-tip"},{from:"chest",to:"right-shoulder"},{from:"right-shoulder",to:"right-scapula"},{from:"right-scapula",to:"right-arm-upper"},{from:"right-arm-upper",to:"right-arm-lower"},{from:"right-arm-lower",to:"right-hand-wrist-twist"},{from:"right-hand-wrist-twist",to:"right-hand-wrist"},{from:"right-hand-wrist",to:"right-hand-palm"},{from:"right-hand-wrist",to:"right-hand-thumb-metacarpal"},{from:"right-hand-thumb-metacarpal",to:"right-hand-thumb-phalanx-proximal"},{from:"right-hand-thumb-phalanx-proximal",to:"right-hand-thumb-phalanx-distal"},{from:"right-hand-thumb-phalanx-distal",to:"right-hand-thumb-tip"},{from:"right-hand-wrist",to:"right-hand-index-metacarpal"},{from:"right-hand-index-metacarpal",to:"right-hand-index-phalanx-proximal"},{from:"right-hand-index-phalanx-proximal",to:"right-hand-index-phalanx-intermediate"},{from:"right-hand-index-phalanx-intermediate",to:"right-hand-index-phalanx-distal"},{from:"right-hand-index-phalanx-distal",to:"right-hand-index-tip"},{from:"right-hand-wrist",to:"right-hand-middle-metacarpal"},{from:"right-hand-middle-metacarpal",to:"right-hand-middle-phalanx-proximal"},{from:"right-hand-middle-phalanx-proximal",to:"right-hand-middle-phalanx-intermediate"},{from:"right-hand-middle-phalanx-intermediate",to:"right-hand-middle-phalanx-distal"},{from:"right-hand-middle-phalanx-distal",to:"right-hand-middle-tip"},{from:"right-hand-wrist",to:"right-hand-ring-metacarpal"},{from:"right-hand-ring-metacarpal",to:"right-hand-ring-phalanx-proximal"},{from:"right-hand-ring-phalanx-proximal",to:"right-hand-ring-phalanx-intermediate"},{from:"right-hand-ring-phalanx-intermediate",to:"right-hand-ring-phalanx-distal"},{from:"right-hand-ring-phalanx-distal",to:"right-hand-ring-tip"},{from:"right-hand-wrist",to:"right-hand-little-metacarpal"},{from:"right-hand-little-metacarpal",to:"right-hand-little-phalanx-proximal"},{from:"right-hand-little-phalanx-proximal",to:"right-hand-little-phalanx-intermediate"},{from:"right-hand-little-phalanx-intermediate",to:"right-hand-little-phalanx-distal"},{from:"right-hand-little-phalanx-distal",to:"right-hand-little-tip"},{from:"hips",to:"left-upper-leg"},{from:"left-upper-leg",to:"left-lower-leg"},{from:"left-lower-leg",to:"left-foot-ankle-twist"},{from:"left-foot-ankle-twist",to:"left-foot-ankle"},{from:"left-foot-ankle",to:"left-foot-subtalar"},{from:"left-foot-subtalar",to:"left-foot-transverse"},{from:"left-foot-transverse",to:"left-foot-ball"},{from:"hips",to:"right-upper-leg"},{from:"right-upper-leg",to:"right-lower-leg"},{from:"right-lower-leg",to:"right-foot-ankle-twist"},{from:"right-foot-ankle-twist",to:"right-foot-ankle"},{from:"right-foot-ankle",to:"right-foot-subtalar"},{from:"right-foot-subtalar",to:"right-foot-transverse"},{from:"right-foot-transverse",to:"right-foot-ball"}];var ho=Object.defineProperty,co=Object.getOwnPropertyDescriptor,po=(s,t,e,n)=>{for(var i=n>1?void 0:n?co(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&ho(t,e,i),i};class li extends d{constructor(){super(...arguments),this.destroyTarget=!1,this._startTime=0}awake(){if(this._rigidbody=this.gameObject.getComponentInParent(N)||void 0,this._rigidbody){const t=this.gameObject.getComponentsInChildren(Xt);for(const e of t){const n=f.addComponent(e.gameObject,mo);n.rigidBody=this._rigidbody,n.arrow=this,n.audioOnImpact=this.audioOnImpact,n.destroyTarget=this.destroyTarget}}this._startTime=this.context.time.time}onBeforeRender(){if(this.context.time.time-this._startTime>5){this.gameObject.destroy();return}if(this._rigidbody){const t=this._rigidbody.getVelocity();if(t.lengthSq()>0){const e=S().set(t.x,t.y,t.z).normalize(),n=Us();n.setFromUnitVectors(S(0,0,1),e),this.gameObject.quaternion.copy(n)}}}}po([l(rt)],li.prototype,"audioOnImpact",2);class mo extends d{constructor(){super(...arguments),this.destroyTarget=!1}onCollisionEnter(t){var e,n;if(this.arrow)if((e=this.audioOnImpact)==null||e.stop(),(n=this.audioOnImpact)==null||n.play(),this.destroyTarget)t.gameObject.destroy(),this.arrow.gameObject.destroy();else{t.gameObject.attach(this.arrow.gameObject),t.rigidBody instanceof N&&t.rigidBody.applyImpulse(t.gameObject.position.clone().multiply(this.rigidBody.getVelocity()),!0);const i=this.rigidBody.gameObject.getComponentsInChildren(Xt);for(const r of i)r.destroy();this.rigidBody.destroy(),this.arrow.destroy()}}}var uo=Object.defineProperty,fo=Object.getOwnPropertyDescriptor,G=(s,t,e,n)=>{for(var i=n>1?void 0:n?fo(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&uo(t,e,i),i};const Pi=E("debugarrow");class z extends d{constructor(){super(...arguments),this.power=1.5,this.drawMaxPhysicalDistance=.47269,this.drawMinPhysicalDistance=.1132593,this._tempLookMatrix=new an,this._tempLookRot=new Ee,this._lastShotTimestamp=Number.MIN_SAFE_INTEGER,this._isAiming=!1,this._bowController=void 0,this._stringController=void 0,this._controllerFollow=null,this._aimingPointerStartPos=new u,this._initialBowObjectRotation=new Ee,this._initialBowObjectPosition=new u,this._screenDragRaycaster=new ln,this._screenDragPlane=new hn,this._screenDragRayLine=new cn,this.onDown=t=>{t.origin instanceof xi?t.button===0&&(this._bowController===void 0?(this._bowController=t.origin.index,this.bowObject.quaternion.copy(this._initialBowObjectRotation)):this._stringController===void 0&&(this._stringController=t.origin.index),this._bowController===this._stringController&&(this._stringController=void 0),this._controllerFollow&&(this._controllerFollow.side=this._bowController,this._controllerFollow.enabled=this._bowController!==void 0),this._isAiming=this._stringController!==void 0):t.button===0&&(this._isAiming=!0,this._stringPointerId=t.pointerId,this.getScreenDragPoint(t.pointerId,this._aimingPointerStartPos))},this.onRelease=t=>{var e;if(t.button===0){if(t.origin instanceof xi){const n=t.origin;if(this._isAiming&&n.index===this._stringController&&n.index!==this._bowController&&typeof this._bowController=="number"){const i=(e=Yt.active)==null?void 0:e.getController(this._bowController);if(n&&i){const r=n.gripWorldPosition;if(r){const o=i.gripWorldPosition.clone().sub(r);let a=i.object.worldPosition.distanceTo(n.object.worldPosition);a-=this.drawMinPhysicalDistance;const h=I.clamp01(a/this.drawMaxPhysicalDistance)*this.power;o.normalize().multiplyScalar(h),this.shoot(r,o),Pi&&L.DrawArrow(r,o.clone().add(r),16776960,1)}}}n.index===this._bowController&&(this._bowController=void 0),n.index===this._stringController&&(this._stringController=void 0),this._isAiming=this._bowController!==void 0&&this._stringController!==void 0,this._controllerFollow&&(this._controllerFollow.enabled=this._bowController!==void 0)}else{const n=this._aimingPointerStartPos,i=this.getScreenDragPoint(this._stringPointerId,S()),r=this.arrowSpawnSpot.getWorldPosition(S()),o=this.bowObject.getWorldDirection(S()).multiplyScalar(-1),a=n.distanceTo(i),h=I.clamp01(a/this.drawMaxPhysicalDistance)*this.power;o.normalize().multiplyScalar(h),this.shoot(r,o)}this._stringPointerId=void 0}}}get _hasControllers(){var t;return(((t=this.context.xr)==null?void 0:t.controllers.length)??0)>0}awake(){var t;(t=this.arrowPrefab)!=null&&t.asset&&(this.arrowPrefab.asset.visible=!1)}async onEnable(){var t;await((t=this.arrowPrefab)==null?void 0:t.loadAssetAsync()),this._isAiming=!1,this._controllerFollow=this.bowObject.getComponentInParent(ks)||null,this._initialBowObjectRotation=this.bowObject.quaternion.clone(),this._initialBowObjectPosition=this.bowObject.position.clone(),this._screenDragPlane.setFromNormalAndCoplanarPoint(S(0,1,-.2),this.bowObject.worldPosition),this.context.input.addEventListener("pointerdown",this.onDown),this.context.input.addEventListener("pointerup",this.onRelease),this.setupArrowInstances()}onDisable(){this._isAiming=!1,this.context.input.removeEventListener("pointerdown",this.onDown),this.context.input.removeEventListener("pointerup",this.onRelease)}onLeaveXR(){this.bowObject.quaternion.copy(this._initialBowObjectRotation),this.bowObject.position.copy(this._initialBowObjectPosition)}getPointerDistanceTo(t,e){const n=this.context.input.getPointerPosition(e);return t.distanceTo(n)}async setupArrowInstances(){var e,n,i;if(!this.arrowPrefab||!this.arrowSpawnSpot||this._drawingArrow)return;const t=await this.arrowPrefab.instantiate({parent:this.arrowSpawnSpot});t&&(t.visible=!0,t.worldScale=S(1,1,1),this._drawingArrow=t,(e=t.getComponent(li))==null||e.destroy(),(n=t.getComponent(N))==null||n.destroy(),(i=t.getComponentInChildren(Ge))==null||i.destroy(),t.getComponentsInChildren(Xt).forEach(r=>r.destroy()))}async shoot(t,e){var c,m;if(!this.arrowPrefab)return;this._lastShotTimestamp=this.context.time.time;const n=t.clone(),i=n.clone().add(e),r=Math.pow(e.length()+.5,2),o=e.clone().normalize(),a=await this.arrowPrefab.instantiate({parent:this.context.scene});if(!a){console.error("Failed to instantiate arrow prefab, please check that objects are assigned correctly.");return}a.worldPosition=n,a.lookAt(i),a.visible=!0;const h=a.getComponent(N);h&&(h.isKinematic=!1,h.autoMass=!1,h.mass=.05,(c=this.sound)==null||c.stop(),(m=this.sound)==null||m.play(),await vt(1),h.applyImpulse(o.multiplyScalar(r),!0))}getScreenDragPoint(t,e){const n=this.context.input.getPointerPositionRC(t);this._screenDragRaycaster.setFromCamera(n,this.context.mainCamera);const i=this._screenDragRaycaster.ray;return this._screenDragRayLine.set(i.origin,i.direction.multiplyScalar(1e5)),this._screenDragPlane.intersectLine(this._screenDragRayLine,e)||e.set(0,0,0),Pi&&L.DrawWireSphere(e,.01,16711680,1),e}onBeforeRender(){if(!this.animationComponent||!this.bowObject)return;if(!this._mixer){this._mixer=new pn(this.bowObject);const h=this.animationComponent.animations.at(0);h&&(this._animation=this._mixer.clipAction(h))}const t=.1;let e=0;const n=S(),i=S(),r=S(this.bowObject.worldUp);if(this._hasControllers){if(!this._isAiming)e=0,this._lastShotTimestamp=this.context.time.time;else if(this.context.xr&&this.context.xr.controllers.length>1&&this._bowController!==void 0&&this._stringController!==void 0){const h=this.context.xr.controllers[this._stringController],c=this.context.xr.controllers[this._bowController];if(!h||!c)return;n.copy(h.gripWorldPosition),i.copy(c.gripWorldPosition)}}else this._stringPointerId!==void 0&&(i.copy(this._aimingPointerStartPos),n.copy(this.getScreenDragPoint(this._stringPointerId,S())));if(this._isAiming&&n.dot(n)>0&&i.dot(i)>0){let h=n.distanceTo(i);e=I.clamp01((h-this.drawMinPhysicalDistance)/this.drawMaxPhysicalDistance),h>.025&&(this._tempLookMatrix.lookAt(n,i,r),this._tempLookRot.setFromRotationMatrix(this._tempLookMatrix),this.bowObject.worldQuaternion=this._tempLookRot)}this.drawProgression&&(e=this.drawProgression.evaluate(e)),!this._isAiming&&!this._hasControllers&&(e=.25),this._animation.timeScale=0;const o=I.lerp(this._animation.time,e,this.context.time.deltaTime/t),a=this._animation.time;if(this._animation.time=o,Math.abs(o-a)>Number.EPSILON&&(this._animation.setEffectiveWeight(1),this._animation.play()),this._mixer.update(this.context.time.deltaTime),this._drawingArrow){let c=(this.context.time.time-this._lastShotTimestamp)/.3;c=this.easeInOutSine(I.clamp01(c)),this._drawingArrow.worldScale=S(1,1,1).multiplyScalar(c)}}easeInOutSine(t){return I.clamp01(-.5*(Math.cos(Math.PI*t)-1))}}G([l(T)],z.prototype,"bowObject",2);G([l(Bt)],z.prototype,"animationComponent",2);G([l(Ai)],z.prototype,"arrowPrefab",2);G([l(T)],z.prototype,"arrowSpawnSpot",2);G([l()],z.prototype,"power",2);G([l(Gs)],z.prototype,"drawProgression",2);G([l()],z.prototype,"drawMaxPhysicalDistance",2);G([l()],z.prototype,"drawMinPhysicalDistance",2);G([l(rt)],z.prototype,"sound",2);var go=Object.defineProperty,bo=Object.getOwnPropertyDescriptor,vo=(s,t,e,n)=>{for(var i=n>1?void 0:n?bo(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&go(t,e,i),i};class us extends d{start(){this._meshRenderer=this.gameObject.getComponentInChildren(Ws)}onDestroy(){if(this.gameObject.visible&&this.particleSystem){if(this.particleSystem.shape.shapeType===_e.MeshRenderer&&this._meshRenderer&&!$i(this._meshRenderer.gameObject)){this.particleSystem.shape.shapeType=_e.MeshRenderer,this.particleSystem.shape.setMesh(this._meshRenderer),this.particleSystem.play();return}this.particleSystem.shape.shapeType=_e.Sphere,this.particleSystem.worldPosition=this.gameObject.worldPosition,this.particleSystem.play()}}}vo([l(Ge)],us.prototype,"particleSystem",2);var yo=Object.defineProperty,xo=Object.getOwnPropertyDescriptor,wo=(s,t,e,n)=>{for(var i=n>1?void 0:n?xo(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&yo(t,e,i),i};class fs extends d{constructor(){super(...arguments),this._instances=new Array}awake(){var t,e;if(!((t=this.prefabs)!=null&&t.length)||((e=this.prefabs)==null?void 0:e.length)===0){console.warn("BowTargetSpawner start: no prefab set"),this.enabled=!1;return}this.prefabs.forEach(n=>n.visible=!1)}update(){var e;if(!((e=this.prefabs)!=null&&e.length))return;const t=S();for(let n=this._instances.length-1;n>=0;n--){const i=this._instances[n];$i(i.instance)?this._instances.splice(n,1):(t.setScalar(i.scale),i.instance.scale.lerp(t,this.context.time.deltaTime))}if(this.context.time.frame%20===0&&Math.random()>.5){const n=this.worldPosition;n.x+=Math.random()*12-6,n.y+=Math.random()*3,n.z+=Math.random()*6;const i=Math.random()*3+.5,r=this.prefabs[Math.floor(Math.random()*this.prefabs.length)],o=Hs(r,{parent:this.scene,position:n.clone(),scale:new u(.01,.01,.01),keepWorldPosition:!0});o.visible=!0,this._instances.push({instance:o,scale:i}),setTimeout(()=>{o.destroy()},7e3),vt(1).then(()=>{const a=o.getComponentInChildren(N);a&&(a.gravityScale=.2+Math.random()*.3,a.mass=2,a.autoMass=!1),a==null||a.setAngularVelocity(I.random(-2,2),I.random(-2,2),I.random(-2,2)),a==null||a.applyImpulse({x:0,y:5+Math.random()*12,z:0})})}}}wo([l(T)],fs.prototype,"prefabs",2);class _o extends d{awake(){this.context.renderer.toneMapping=dn,_i.occlusion_fragment=_i.occlusion_fragment.replace("gl_FragColor *= 1.0 - occlusion;",`
float depthMm = Depth_GetCameraDepthInMeters(depthColor, depthUv, arrayIndex);

// requires also patching ShaderChunk.occlusion_pars_fragment and adding some noise function
// float noise = snoise(gl_FragCoord.xy * 0.005);
// depthMm += noise * 0.002;

float absDistance = abs(assetDepthM - depthMm);
float v = 0.0025;
absDistance = saturate(v - absDistance) / v;

gl_FragColor.rgb += vec3(absDistance * 2.0, absDistance * 2.0, absDistance * 12.0);
gl_FragColor = mix(gl_FragColor, vec4(0.0, 0.0, 0.0, 0.0), occlusion * 0.7);
`)}}class Oo extends d{constructor(){super(...arguments),this.interval=-1,this.supportsAR=!1,this.supportsVR=!1}async onEnable(){this.log(!0),this.interval=setInterval(()=>this.log(),500),this.supportsAR=await Yt.isARSupported(),this.supportsVR=await Yt.isVRSupported()}onDisable(){clearInterval(this.interval)}async log(t=!1){t&&(console.log("UserAgent",window.navigator.userAgent),console.log("isMobileDevice",w.isMobileDevice()),console.log("isiOSDevice",w.isiOS()),console.log("isMozillaXR",w.isMozillaXR()),console.log("isSafari",w.isSafari()),console.log("isQuest",w.isQuest()),console.log("isMacOS",w.isMacOS()),console.log("isVisionOS",w.isVisionOS())),b("AR: "+e(this.supportsAR)+", VR: "+e(this.supportsVR)+", QuickLook: "+e(w.supportsQuickLookAR())),w.isMobileDevice()?w.isiOS()?b("iOS "):window.navigator.userAgent.indexOf("Android")>-1?b("Android "):b("Other Mobile "):w.isDesktop()?b("Desktop "):b("Other Device "),w.isMobileDevice()&&w.isiOS()&&w.isSafari()?b("Safari "):w.isMozillaXR()?b("Mozilla XR "):w.isQuest()?b("Quest "):window.navigator.userAgent.indexOf("Chrome")>-1?b("Chrome "):b("Other Browser "),b("UserAgent: "+window.navigator.userAgent);function e(n){return n?"":""}}}class Po extends d{onEnable(){const t=f.findObjectOfType(We);t&&(t.anchoringType="plane",t.planeAnchoringAlignment="vertical")}}var Co=Object.defineProperty,So=Object.getOwnPropertyDescriptor,Dt=(s,t,e,n)=>{for(var i=n>1?void 0:n?So(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Co(t,e,i),i};class ot extends d{constructor(){super(...arguments),this.distance=.5,this.fadeDuration=1,this.targetState=!0,this.hideOnStart=!0,this.tempVector=new u}start(){this.hideOnStart&&!w.isiOS()&&this.target.scale.set(0,0,0)}update(){this.tempVector.copy(this.context.mainCameraComponent.worldPosition),this.tempVector.sub(this.worldPosition).length()<this.distance&&(this.enabled=!1)}createBehaviours(t,e,n){if(e.uuid===this.gameObject.uuid){const i=this.target?this.target:this.gameObject;this.hideOnStart&&t.addBehavior(new Y("SetActiveOnProximity_active_"+this.gameObject.name,K.sceneStartTrigger(),A.fadeAction(i,0,!this.targetState))),t.addBehavior(new Y("SetActiveOnProximity_"+this.gameObject.name,K.proximityToCameraTrigger(this.gameObject,this.distance),A.fadeAction(i,this.fadeDuration,this.targetState)))}}}Dt([l(f)],ot.prototype,"target",2);Dt([l()],ot.prototype,"distance",2);Dt([l()],ot.prototype,"fadeDuration",2);Dt([l()],ot.prototype,"targetState",2);Dt([l()],ot.prototype,"hideOnStart",2);var Io=Object.defineProperty,Do=Object.getOwnPropertyDescriptor,hi=(s,t,e,n)=>{for(var i=n>1?void 0:n?Do(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Io(t,e,i),i};class oe extends d{constructor(){super(...arguments),this.getCloseClip="",this.distance=.5,this.lastDistance=void 0}update(){const t=this.gameObject.worldPosition.distanceTo(this.context.mainCameraComponent.worldPosition);this.lastDistance!==void 0&&t<this.distance&&this.lastDistance>=this.distance&&this.target.play(this.getCloseClip),this.lastDistance=t}createBehaviours(t,e,n){if(e.uuid===this.gameObject.uuid){const i=this.target?this.target.gameObject:this.gameObject,r=n.extensions.find(h=>h instanceof qs);if(!r){console.warn("No AnimationExtension found",n.extensions);return}let o;const a=wi.getAndRegisterAnimationSequences(r,i,this.getCloseClip);if(a)o=wi.getActionForSequences(i,a.animationSequence,a.animationLoopAfterSequence,a.randomTimeOffset);else{console.warn("No animation sequence found for "+this.getCloseClip,a);return}t.addBehavior(new Y("PlayAnimationOnProximity_"+this.gameObject.name,K.proximityToCameraTrigger(this.gameObject,this.distance),o));return}}}hi([l(X)],oe.prototype,"target",2);hi([l()],oe.prototype,"getCloseClip",2);hi([l()],oe.prototype,"distance",2);var jo=Object.defineProperty,Eo=Object.getOwnPropertyDescriptor,ae=(s,t,e,n)=>{for(var i=n>1?void 0:n?Eo(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&jo(t,e,i),i};class jt extends d{constructor(){super(...arguments),this.distance=.5,this.targetState=!0}createBehaviours(t,e,n){}async afterSerialize(t,e){}}ae([l(rt)],jt.prototype,"target",2);ae([l(URL)],jt.prototype,"clip",2);ae([l()],jt.prototype,"distance",2);ae([l()],jt.prototype,"targetState",2);var To=Object.defineProperty,Mo=Object.getOwnPropertyDescriptor,at=(s,t,e,n)=>{for(var i=n>1?void 0:n?Mo(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&To(t,e,i),i};class le{constructor(){this.contents=[],this.negativeContents=[],this.triggers=[]}}at([l(T)],le.prototype,"contents",2);at([l(T)],le.prototype,"negativeContents",2);at([l(T)],le.prototype,"triggers",2);class he extends d{constructor(){super(...arguments),this.elements=[],this.fadeDuration=.2,this.selectFirstOnStart=!0,this._allTargets=[],this._allTriggers=[]}get currentIndex(){return this._currentIndex}get defaultVariant(){const t=this.selectFirstOnStart?this.elements.at(0):void 0;return this._currentIndex!==void 0?this.elements.at(this._currentIndex):t}awake(){this.elements.forEach(t=>{t.contents=t.contents.filter(e=>e),t.triggers=t.triggers.filter(e=>e)}),this.elements.forEach(t=>{var e;return(e=t.contents)==null?void 0:e.forEach(n=>this._allTargets.push(n))}),this.elements.forEach(t=>{var e;return(e=t.triggers)==null?void 0:e.forEach(n=>this._allTriggers.push(n))}),this.setupForRuntime()}setupForRuntime(){this.elements.forEach((t,e)=>{var n;(n=t.triggers)==null||n.forEach(i=>{const r=Ys(i,Ue);r.onClick??(r.onClick=new g),r.onClick.addEventListener(()=>{this._currentIndex=e,this._allTargets.forEach(o=>{o.visible=t.contents.includes(o)})})})}),this.selectDefault()}selectDefault(){var e;const t=((e=this.defaultVariant)==null?void 0:e.contents)??[];this._allTargets.forEach(n=>{n.visible=t.includes(n)})}createBehaviours(t,e,n){e.uuid===this.gameObject.uuid&&this.setupForUSDZ(t)}beforeCreateDocument(t,e){this._allTargets.forEach(n=>{n.visible=!0})}async afterSerialize(t,e){await vt(3),this.selectDefault()}setupForUSDZ(t){var i;this.elements.forEach(r=>{var o;(o=r.triggers)==null||o.forEach(a=>{const h=r.contents,c=this._cloneArray(this._allTargets).filter(m=>!h.includes(m));h.length>=0&&t.addBehavior(new Y(`EnableObject_${a.uuid}`,K.tapTrigger(a),A.fadeAction(h,this.fadeDuration,!0))),c.length>=0&&t.addBehavior(new Y(`DisableObject_${a.uuid}`,K.tapTrigger(a),A.fadeAction(c,this.fadeDuration,!1)))})});const e=((i=this.defaultVariant)==null?void 0:i.contents)??[],n=this._cloneArray(this._allTargets).filter(r=>!e.includes(r));t.addBehavior(new Y(`HideOnStart_${this.guid}`,K.sceneStartTrigger(),A.fadeAction(n,0,!1)))}_cloneArray(t){const e=new Array(t.length);return t.forEach((n,i)=>e[i]=n),e}}at([l(le)],he.prototype,"elements",2);at([l()],he.prototype,"fadeDuration",2);at([l()],he.prototype,"selectFirstOnStart",2);var Ao=Object.defineProperty,$o=Object.getOwnPropertyDescriptor,k=(s,t,e,n)=>{for(var i=n>1?void 0:n?$o(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Ao(t,e,i),i};class lt{constructor(){this.name="Name"}}k([l()],lt.prototype,"name",2);k([l(Jt)],lt.prototype,"icon",2);k([l(g)],lt.prototype,"click",2);class ht{constructor(){this.title="Title",this.items=[]}}k([l()],ht.prototype,"title",2);k([l(Jt)],ht.prototype,"icon",2);k([l(g)],ht.prototype,"select",2);k([l(g)],ht.prototype,"deselect",2);k([l(lt)],ht.prototype,"items",2);class Et extends d{constructor(){super(...arguments),this.categories=[]}awake(){document.body.insertAdjacentHTML("afterbegin",`<style>${zo}</style>`),document.body.insertAdjacentHTML("afterbegin",No),this.mainmenu=document.querySelector(".mainmenu"),this.submenuRoot=document.querySelector(".submenu-wrapper"),this.submenu=document.querySelector(".submenu"),this.submenuTitle=document.querySelector(".submenu-title"),this.submenuContent=document.querySelector(".submenu-content"),this.categories.forEach(t=>this.addCategory(t)),this.hideSubmenu()}addNewCategory(t){this.categories.push(t),this.addCategory(t)}addCategory(t){if(!this.mainmenu)return;const e=Fo(t);this.mainmenu.appendChild(e),e.onclick=()=>{this.selectedCategory===t?this.hideSubmenu():this.showSubmenu(t)}}addItem(t){if(!this.submenuContent)return;const e=Ro(t);this.submenuContent.appendChild(e),e.onclick=()=>{var n;(n=t.click)==null||n.invoke()}}showSubmenu(t){var e,n,i,r;for(this.selectedCategory=t,(n=(e=this.selectedCategory)==null?void 0:e.select)==null||n.invoke(),this.submenuTitle&&(this.submenuTitle.textContent=t.title);(i=this.submenuContent)!=null&&i.firstChild;)this.submenuContent.removeChild(this.submenuContent.firstChild);t.items.forEach(o=>this.addItem(o)),(r=this.submenuRoot)==null||r.classList.remove("close")}hideSubmenu(){var t,e,n,i,r;for((e=(t=this.selectedCategory)==null?void 0:t.deselect)==null||e.invoke(),this.selectedCategory=void 0;(n=this.submenuContent)!=null&&n.firstChild;)(i=this.submenuContent)==null||i.removeChild(this.submenuContent.firstChild);(r=this.submenuRoot)==null||r.classList.add("close")}}k([l(ht)],Et.prototype,"categories",2);const Lo="https://upload.wikimedia.org/wikipedia/commons/2/21/City_locator_4.svg",Fo=s=>{var e;const t=document.createElement("button");return t.classList.add("room"),t.classList.add("open-submenu"),t.innerHTML=`
        <button class="open-submenu">
            <span class="icon">
                <img src=${((e=s.icon)==null?void 0:e.url)??Lo} alt=${s.title??"?"}>
            </span>
        </button>
    `,t},Ro=s=>{var i;const t=document.createElement("button");t.classList.add("submenu-button");const e=`
        <img src=${(i=s.icon)==null?void 0:i.url} alt=${s.name??"?"}>
    `,n=`
        <a>${s.name}</a>
    `;return s.icon&&(t.innerHTML+=e),t.innerHTML+=n,t},No=`
  <div class="mainmenu">
    <!-- Content -->
  </div>

  <div class="submenu-wrapper">
    <h2 class="submenu-title"></h2>
    <div class="submenu">
        <div class="submenu-content">
            <!-- Content -->
        </div>
    </div>
  </div>
`,zo=`
.mainmenu {
    position: absolute;
    top: 16px;
    right: 16px;
    display: flex;
    padding: 4px;
    flex-direction: column;
    align-items: center;
    background: rgba(229, 230, 233, 0.8);
    border-radius: 50%;
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    box-shadow: 0 0 4px rgba(2, 2, 43, 0.2);
    z-index: 1;

    /* default font settings */
    font-size: 1rem;
    font-family: 'Roboto Flex', sans-serif;
    /* font-optical-sizing: auto; */
    /* font-variation-settings: "width" 100; */
    color: rgb(40, 40, 40);
}

.mainmenu button {
    width: 42px;
    height: 42px;
    border: none;
    border-radius: 50%;
    background: transparent;
    transition: background-color 0.5s;
    outline: rgba(0, 0, 0, 0) 1px solid;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
}

.mainmenu button.active,
.mainmenu button:hover {
    background: rgba(245, 245, 245, .8);
    transition: all 0.1s linear .02s;
    outline: rgba(0, 0, 0, .05) 1px solid;
}

.mainmenu button.active img,
.mainmenu button:hover img
{
    /* filter: invert(100%) sepia(0%) saturate(7478%) hue-rotate(317deg) brightness(109%) contrast(99%); */
}

.mainmenu button img {
    width: 32px;
    height: 32px;
}

.mainmenu button .state-icon {
    position: absolute;
    top: 9px;
    left: 11px;
    width: 32px; 
    height: 32px; 
    background-size: cover;
    background-repeat: no-repeat;
    pointer-events: none; 
    filter: invert(61%) sepia(85%) saturate(1169%) hue-rotate(92deg) brightness(92%) contrast(86%);
}

.mainmenu button.active .state-icon,
.mainmenu button:hover .state-icon
{
    filter: invert(61%) sepia(85%) saturate(1169%) hue-rotate(92deg) brightness(92%) contrast(86%);
}

/*Submenu*/
.submenu-wrapper {
    position: absolute;
    top: 16px;
    right: calc(70px + 10px);
    width: 333px;
    max-height: 60vh;
    padding: 22px;
    z-index: 1;

    background: #ffffff5c;
    border: 1px solid rgba(255, 255, 255, .1);
    border-radius: 1.1999rem;
    outline: rgb(0 0 0 / 5%) 1px solid;
    box-shadow: 0px 7px 0.5rem 0px rgb(0 0 0 / 6%), inset 0px 0px 1.3rem rgba(0, 0, 0, .05);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);

    overflow: hidden;
}

.submenu {
    overflow-x: hidden;
    overflow-y: scroll;
    max-height: calc(60vh - 22px * 2);
    font-family: 'Roboto Flex', sans-serif;
}

/* width */
.submenu::-webkit-scrollbar {
    scrollbar-color: #ff0000;
    width: 5px;
}

/* Track */
.submenu::-webkit-scrollbar-track {
    background: #8880;
    margin-right: 20px;
}

/* Handle */
.submenu::-webkit-scrollbar-thumb {
    background: #8888;
    border-radius: 10px; /* Rounded corners */
    margin: 0 8px; /* Offset the track to move the thumb left */
}

/* Handle on hover */
.submenu::-webkit-scrollbar-thumb:hover {
    background: #555A;
}

.submenu-title {
    color: #282828;
    font-size: 22px;
    font-weight: 800;
    line-height: 32px;
    margin-bottom: 16px;
    margin-top: 0px;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
    border-bottom: 1px solid rgba(40, 40, 40, .4);
    font-family: 'Roboto Flex', sans-serif;
}

.submenu-button {
    height: 1.8rem;
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    font-size: 1rem;
    line-height: 32px;
    border: none;
    cursor: pointer;
    font-family: 'Roboto Flex', sans-serif;
    font-weight: 200;
    width: 100%;
    
    background: transparent;
    outline: rgba(0, 0, 0, 0) 1px solid;
    border-radius: 0.8rem;
}

.submenu-button:hover { 
    background: rgba(245, 245, 245, .8);
    transition: all 0.1s linear .02s;
    outline: rgba(0, 0, 0, .05) 1px solid;
}

.submenu-button img {
    width: 32px;
    height: 32px;
    margin-right: 6px;
    margin-left: -6px;
}

.submenu-button a {
    color: #282828;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
}

.submenu-content img {
    max-width: 100%;
    height: auto;
    margin-right: 6px;
}

.special {
    display: flex;
    align-items: center;
    margin-top: 16px;
    font-size: 13px;
    line-height: 20px;
    color: #919191;
    border: none;
    background: none;
}

.special img {
    width: 16px;
    height: 16px;
    filter: invert(61%) sepia(85%) saturate(1169%) hue-rotate(92deg) brightness(92%) contrast(86%);
}

.submenu-wrapper.close {
    display: none;
}

@media screen and (max-width: 768px) {
    .mainmenu {
        width: 42px;
        height: auto;
        padding-bottom: 2px;
    }

    .mainmenu button {
        width: 32px;
        height: 32px;
    }

    .mainmenu button img {
        width: 24px;
        height: 24px;
    }

    .mainmenu button .state-icon {
        position: absolute;
        top: 9px;
        left: 9px;
        width: 24px; 
        height: 24px; 
    }

    .submenu-wrapper {
        right: calc(60px + 5px);
        width: 256px;
        border-radius: 21px;
        padding: 16px;
        max-height: 40vh;
    }

    .submenu {
        max-height: calc(40vh - 16px * 2);
    }

    .submenu-title {
        font-size: 18px;
        line-height: 28px;
        margin-bottom: 10px;
    }

    .submenu-button {
        margin-bottom: 6px;
        /* font-size: 1.3rem; */
        line-height: 24px;
    }

    .submenu-button img {
        width: 24px;
        height: 24px;
    }

    .special {
        margin-top: 10px;
        font-size: 11px;
    }

    .special img {
        width: 10px;
        height: 10px;
    }
}`;var Vo=Object.defineProperty,Uo=Object.getOwnPropertyDescriptor,ct=(s,t,e,n)=>{for(var i=n>1?void 0:n?Uo(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Vo(t,e,i),i};class ci{}ct([l(Ue)],ci.prototype,"button",2);ct([l(D)],ci.prototype,"label",2);class Tt extends d{constructor(){super(...arguments),this.categoryName="",this.data=[]}awake(){var e;this.galleryUI??(this.galleryUI=Li(Et));const t=(e=this.galleryUI)==null?void 0:e.categories.find(n=>n.title===this.categoryName);t&&this.data.forEach(n=>{var r,o;const i=new lt;i.name=((r=n.label)==null?void 0:r.text)||"",i.icon=this.icon,i.click=new g,(o=i.click)==null||o.addEventListener(()=>{var a,h;(h=(a=n.button)==null?void 0:a.onClick)==null||h.invoke()}),t.items.push(i)})}}ct([l(Et)],Tt.prototype,"galleryUI",2);ct([l()],Tt.prototype,"categoryName",2);ct([l(Jt)],Tt.prototype,"icon",2);ct([l(ci)],Tt.prototype,"data",2);var Go=Object.defineProperty,ko=Object.getOwnPropertyDescriptor,gs=(s,t,e,n)=>{for(var i=n>1?void 0:n?ko(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Go(t,e,i),i};class ce extends d{constructor(){super(...arguments),this.title="",this.slug=""}initialize(t){this.galleryManager=t}start(){this.slug=Wo(this.title),E("poi")===this.slug&&this.focus()}focus(){var t,e;ke("poi",this.slug),(t=this.galleryManager)==null||t.poiFocused(this),this.cameraView&&(this.previousOrbitControls??(this.previousOrbitControls=Li(ze)),(e=this.previousOrbitControls)==null||e.setCameraAndLookTarget(this.cameraView))}focusNext(){var t;(t=this.galleryManager)==null||t.focusNext(this)}focusPrevious(){var t;(t=this.galleryManager)==null||t.focusPrevious(this)}}gs([l(T)],ce.prototype,"cameraView",2);gs([l()],ce.prototype,"title",2);function Wo(s){return s.trim().toLowerCase().replace(/ /g,"-")}var Ho=Object.defineProperty,qo=Object.getOwnPropertyDescriptor,Mt=(s,t,e,n)=>{for(var i=n>1?void 0:n?qo(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Ho(t,e,i),i};class pt extends d{constructor(){super(...arguments),this.pois=[],this.categoryName="",this.arrowKeysNavigation=!0,this.selectedPOIIndex=0}awake(){this.populateGalleryUI(this.pois),this.pois.forEach(t=>t.initialize(this))}populateGalleryUI(t){var n;if(!this.galleryUI)return;const e=(n=this.galleryUI)==null?void 0:n.categories.find(i=>i.title===this.categoryName);e&&t.forEach(i=>{const r=new lt;r.name=i.title,r.icon=this.icon,r.click=new g,r.click.addEventListener(()=>{i.focus()}),e.items.push(r)})}poiFocused(t){const e=this.pois.indexOf(t);e!=-1&&(this.selectedPOIIndex=e)}focusNext(t){var e;t&&(this.selectedPOIIndex=this.pois.indexOf(t)),this.selectedPOIIndex=(this.selectedPOIIndex+1)%this.pois.length,(e=this.pois[this.selectedPOIIndex])==null||e.focus()}focusPrevious(t){var e;t&&(this.selectedPOIIndex=this.pois.indexOf(t)),this.selectedPOIIndex=(this.selectedPOIIndex-1+this.pois.length)%this.pois.length,(e=this.pois[this.selectedPOIIndex])==null||e.focus()}update(){if(this.arrowKeysNavigation){const t=this.context.input;t.isKeyDown("ArrowRight")?this.focusNext():t.isKeyDown("ArrowLeft")&&this.focusPrevious()}}}Mt([l(ce)],pt.prototype,"pois",2);Mt([l(Et)],pt.prototype,"galleryUI",2);Mt([l()],pt.prototype,"categoryName",2);Mt([l(Jt)],pt.prototype,"icon",2);Mt([l()],pt.prototype,"arrowKeysNavigation",2);var Yo=Object.defineProperty,Ko=Object.getOwnPropertyDescriptor,bs=(s,t,e,n)=>{for(var i=n>1?void 0:n?Ko(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Yo(t,e,i),i};const Oe=E("debugmaterialx");class pi extends d{constructor(){super(...arguments),this.images=[]}async awake(){this.materialXAsset&&this.loadMaterialX(this.materialXAsset)}async loadMaterialX(t){const e=f.getComponent(this.gameObject,$);if(!e)return;const n=new mn;n.resolveURL=o=>{if(o.startsWith("assets/"))return o;const h=o.split("/").pop();return Oe&&console.log("resolveURL",o,h),"assets/"+h};const r=await new On(n).setPath("").loadAsync(t).then(({materials:o})=>(Oe&&console.log("Loaded .mtlx materials",o),Object.values(o)[0]));Oe&&console.log("Loaded .mtlx material",r,t),r&&(e.sharedMaterial=r)}}bs([l(URL)],pi.prototype,"materialXAsset",2);bs([l(Ks)],pi.prototype,"images",2);const Qo=E("debugmaterialx");class Zo extends d{start(){const t=f.getComponent(this.gameObject,$);t&&(this.material=new un({}),t.sharedMaterial=this.material,this.constructNodeGraph(this.material),this.material.needsUpdate=!0)}constructNodeGraph(t){const e=fn(1),n=gn.mul(10).add(e),i=bn(n);t.colorNode=i}update(){if(bt()&&this.material&&this.constructNodeGraph!==this.methodCacheKey){Qo&&console.log("rebuilding node graph"),this.methodCacheKey=this.constructNodeGraph;try{this.constructNodeGraph(this.material),this.material.needsUpdate=!0}catch(t){throw console.error(t),b(t.message,He.Error),t}}}}var Bo=Object.defineProperty,Xo=Object.getOwnPropertyDescriptor,Jo=(s,t,e,n)=>{for(var i=n>1?void 0:n?Xo(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Bo(t,e,i),i};class Le extends d{constructor(){super(...arguments),this.time=0,this._timeThreshold=.3}awake(){this._director=this.gameObject.getComponentInChildren(Qs)??void 0}onAfterRender(){if(!this._director)return;Math.abs(this._director.time-this.time)>this._timeThreshold&&(this.time=this._director.time)}onTimeChanged(){!this._director||Math.abs(this._director.time-this.time)<this._timeThreshold||(this._director.time=this.time,this._director.isPlaying||this._director.evaluate())}}Jo([Q(Le.prototype.onTimeChanged)],Le.prototype,"time",2);var ta=Object.defineProperty,ea=Object.getOwnPropertyDescriptor,dt=(s,t,e,n)=>{for(var i=n>1?void 0:n?ea(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&ta(t,e,i),i};class J extends d{constructor(){super(...arguments),this.consumeClick=!0,this.consumeDown=!0,this.consumeMove=!0,this.consumeUp=!0,this.consumeHover=!0,this.stopPropagation=!0}onPointerDown(t){this.consumeDown&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerMove(t){this.consumeMove&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerUp(t){this.consumeUp&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerClick(t){this.consumeClick&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerEnter(t){this.consumeHover&&t.use(),this.stopPropagation&&t.stopPropagation()}onPointerExit(t){this.consumeHover&&t.use(),this.stopPropagation&&t.stopPropagation()}}dt([l()],J.prototype,"consumeClick",2);dt([l()],J.prototype,"consumeDown",2);dt([l()],J.prototype,"consumeMove",2);dt([l()],J.prototype,"consumeUp",2);dt([l()],J.prototype,"consumeHover",2);dt([l()],J.prototype,"stopPropagation",2);var ia=Object.defineProperty,sa=Object.getOwnPropertyDescriptor,na=(s,t,e,n)=>{for(var i=n>1?void 0:n?sa(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&ia(t,e,i),i};class vs extends d{constructor(){super(...arguments),this.renderers=[]}select(t){this.renderers.forEach(e=>{e.probeAnchor=t})}}na([l($)],vs.prototype,"renderers",2);var ra=Object.defineProperty,oa=Object.getOwnPropertyDescriptor,aa=(s,t,e,n)=>{for(var i=n>1?void 0:n?oa(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&ra(t,e,i),i};class di extends d{constructor(){super(...arguments),this.displayName=""}}aa([l()],di.prototype,"displayName",2);var la=Object.defineProperty,ha=Object.getOwnPropertyDescriptor,pe=(s,t,e,n)=>{for(var i=n>1?void 0:n?ha(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&la(t,e,i),i};class At extends d{constructor(){super(...arguments),this.objects=[],this.hideContentOnStart=!0,this.index=-1}awake(){this.hideContentOnStart||(this.index=0);const t=E("variant");typeof t=="string"?this.index=parseInt(t):typeof t=="number"&&(this.index=t),this.apply()}next(){this.select(this.index+1)}previous(){this.select(this.index-1)}apply(){for(let t=0;t<this.objects.length;t++)this.objects[t].visible=t===this.index;if(this.lable){const t=this.objects[this.index];if(t){const e=f.getComponent(t,di);this.lable.text=(e==null?void 0:e.displayName)??t.name}}}select(t){t<0&&(t=this.objects.length-1),this.index=t%this.objects.length,this.index=I.clamp(this.index,0,this.objects.length-1),ke("variant",this.index.toString()),this.apply()}}pe([l(T)],At.prototype,"objects",2);pe([l()],At.prototype,"hideContentOnStart",2);pe([l(D)],At.prototype,"lable",2);pe([Q(function(){this.apply()})],At.prototype,"index",2);p.add("AspectRatioFitterUI",Qe);p.add("CameraGoal",te);p.add("CameraLayer",Dn);p.add("Cannon",_t);p.add("RandomColor",Be);p.add("ChangeColorOnCollision",An);p.add("IncreaseShaderSpeedOverTime",Hi);p.add("ClickButton",qi);p.add("ClickToReset",Yi);p.add("DepthOfFieldController",ie);p.add("DisableEnvironmentLight",Hn);p.add("EmitParticlesOnClick",Ki);p.add("EnforceParameters",Qi);p.add("HTMLButtonClick",Je);p.add("HTMLMenu",ti);p.add("IFrameContent",Ot);p.add("ImageTrackingDownloadUI",rr);p.add("LODGroupUI",ei);p.add("Networking_ClickToChangeColor",Te);p.add("Networking_StringArray",Me);p.add("Networking_Object",Ae);p.add("PerformanceSettings",si);p.add("Photographer",Pt);p.add("PhysicsCollision",Ct);p.add("PhysicsTrigger",St);p.add("PlayAnimationOnCollision",ts);p.add("PlayAnimationOnTrigger",es);p.add("PlayAudioOnCollision",is);p.add("ResetAnimationsForXR",Sr);p.add("ResponsiveContent",ni);p.add("LoadingSceneRoot",ns);p.add("SceneLoadingEvents",oi);p.add("SceneSwitcherControls",Tr);p.add("SetBackfaceCulling",Mr);p.add("ShowBalloonMessage",rs);p.add("SimpleLeaderboard",$e);p.add("StartPosition",os);p.add("AutoReset",as);p.add("SyncedRoomUI",ls);p.add("TimedSpawn",hs);p.add("TopMenu",cs);p.add("VideoBackground",Xr);p.add("ResetPositionOnInterval",It);p.add("ToggleVisibility",eo);p.add("WireframeMaterial",ps);p.add("XRLifecycleEvents",ai);p.add("WebXRBodyTracking",ao);p.add("Arrow",li);p.add("ArrowShooting",z);p.add("BowArrowTarget",us);p.add("BowTargetSpawner",fs);p.add("CustomDepthSensing",_o);p.add("DeviceDetection",Oo);p.add("CustomUSDSettings",Po);p.add("FadeOnProximity",ot);p.add("PlayAnimationOnProximity",oe);p.add("SoundOnProximity",jt);p.add("EverywhereConfigurator",he);p.add("ButtonAndTextFiller",Tt);p.add("GalleryManager",pt);p.add("GalleryPOI",ce);p.add("GalleryUI",Et);p.add("MaterialXAsset",pi);p.add("ShadeWithMaterialX",Zo);p.add("SyncedPlayableDirector",Le);p.add("ConsumeAllPointers",J);p.add("ReflectionsSwitcher",vs);p.add("VariantInfo",di);p.add("VariantSwitcher",At);var ft=E("pointerlockdebug");const Wt=class extends vn{constructor(s){super(),this.domElement=s,this._onMouseMove=this.onMouseMove.bind(this),this._onPointerlockChange=this.onPointerlockChange.bind(this),this._onPointerlockError=this.onPointerlockError.bind(this),this.connect()}connect(){this.domElement.ownerDocument.addEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this._onPointerlockChange),ft&&this.domElement.ownerDocument.addEventListener("pointerlockerror",this._onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this._onPointerlockChange),ft&&this.domElement.ownerDocument.removeEventListener("pointerlockerror",this._onPointerlockError)}dispose(){this.disconnect()}async lock(){ft&&console.log("Locking pointer");try{await this.domElement.requestPointerLock()}catch{ft&&console.log("Locking pointer")}}unlock(){ft&&console.log("Locking pointer"),this.domElement.ownerDocument.exitPointerLock()}onMouseMove(){Wt.IsLocked}onPointerlockChange(){this.domElement.ownerDocument.pointerLockElement===this.domElement?Wt.IsLocked=!0:Wt.IsLocked=!1}onPointerlockError(){console.error("PointerLock: Unable to use Pointer Lock API")}};let st=Wt;st.IsLocked=!1;var ca=Object.defineProperty,pa=Object.getOwnPropertyDescriptor,M=(s,t,e,n)=>{for(var i=n>1?void 0:n?pa(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&ca(t,e,i),i};class C extends d{constructor(){super(...arguments),this.lookSensitivity=1,this.movementSpeed=50,this.sprintSpeed=80,this.maxSpeed=7,this.maxSprintSpeed=7,this.jumpSpeed=5,this.xRotClamp=new R(-89,89),this.enableTouchInput=!0,this.enableDesktopInput=!0,this.enableGamepadInput=!0,this.gamepadDeadzone=.25,this.gamepadLookSensitivity=50,this.isMobile=!1,this.x=0,this.y=0,this.lookInput=new R,this.moveInput=new R,this.jumpInput=!1,this.sprintInput=!1,this.gamepadIndex=null,this.isInitialized=!1,this.pointerMoveFn=null,this.gamePadConnFn=null,this.gamePadDisconnFn=null,this.upVector=new u(0,1,0),this.moveDir=new u,this.fwdDir=new u,this.upDir=new u(0,1,0),this.rightDir=new u,this.jumpVec=new u,this.zeroValue=new u}awake(){this.playerState=this.gameObject.getComponent(Ye),this.syncedTransform=this.gameObject.getComponent(Fi),this.mainCamera=this.gameObject.getComponentInChildren(Ve),this.isMultiplayer()?this.playerState.onOwnerChangeEvent.addEventListener(()=>this.onOwnerChanged()):this.onOwnerChanged()}start(){this.setCamRotationFromObject()}initialize(){this.isInitialized=!0,this.yRotTarget=this.gameObject,this.isMobile=qe(),this.lock=new st(this.context.domElement),this.isMobile&&(this.lookSensitivity*=2);const t=window.devicePixelRatio;t>1&&(this.lookSensitivity*=t),this.isMobile&&(this.context.domElement.style.userSelect="none",this.context.domElement.style.touchAction="none",this.context.renderer.domElement.style.touchAction="none")}registerInput(){this.pointerMoveFn??(this.pointerMoveFn=this._onPointerMove.bind(this)),this.gamePadConnFn??(this.gamePadConnFn=this.onGamepadConnected.bind(this)),this.gamePadDisconnFn??(this.gamePadDisconnFn=this.onGamepadDisconnected.bind(this)),this.enableDesktopInput&&window.addEventListener("pointermove",this.pointerMoveFn),window.addEventListener("gamepadconnected",this.gamePadConnFn),window.addEventListener("gamepaddisconnected",this.gamePadDisconnFn),this.context.renderer.domElement.addEventListener("pointerdown",()=>{this.enableDesktopInput&&!st.IsLocked&&!this.isMobile&&this.lock.lock()})}unregisterInput(){window.removeEventListener("pointermove",this.pointerMoveFn),window.removeEventListener("gamepadconnected",this.gamePadConnFn),window.removeEventListener("gamepaddisconnected",this.gamePadDisconnFn)}onOwnerChanged(){this.destroyed||(this.isInitialized||this.initialize(),this.setRole(this.isLocalPlayer()))}setCamRotationFromObject(){var r;const t=new u;(r=this.yRotTarget)==null||r.getWorldDirection(t),t.y=0,t.normalize();const e=new u(0,0,1),i=new u(1,0,0).dot(t)>0?1:-1;this.y=e.angleTo(t)*i}isMultiplayer(){return this.playerState!=null&&this.context.connection.isInRoom}isLocalPlayer(){return this.playerState!=null&&this.playerState.isLocalPlayer||!this.isMultiplayer()}setRole(t){var e;this.controller&&(this.controller.enabled=t,this.controller.rigidbody.isKinematic=!t),this.enabled=t,t?((e=this.syncedTransform)==null||e.requestOwnership(),this.registerInput()):this.unregisterInput(),this.mainCamera&&(this.mainCamera.enabled=t)}onBeforeRender(){this.isInitialized&&(this.enableTouchInput&&this.isMobile&&this.gatherMobileInput(),this.enableDesktopInput&&st.IsLocked&&this.gatherDesktopInput(),this.enableGamepadInput&&this.gatherGamepadInput(),this.handleMove(this.moveInput,this.jumpInput,this.sprintInput,()=>this.jumpInput=!1),this.handleLookVec(this.lookInput),this.moveInput.set(0,0),this.lookInput.set(0,0),this.sprintInput=!1)}gatherMobileInput(){const t=this.context.input.getPointerPositionDelta(0);t&&this.lookInput.copy(t)}gatherDesktopInput(){const t=this.context.input;t.isKeyPressed("s")||t.isKeyPressed("DownArrow")?this.moveInput.y+=-1:(t.isKeyPressed("w")||t.isKeyPressed("UpArrow"))&&(this.moveInput.y+=1),t.isKeyPressed("d")||t.isKeyPressed("RightArrow")?this.moveInput.x+=1:(t.isKeyPressed("a")||t.isKeyPressed("LeftArrow"))&&(this.moveInput.x+=-1),t.isKeyDown(" ")?this.jumpInput||(this.jumpInput=!0):t.isKeyUp(" ")&&(this.jumpInput=!1),this.sprintInput||(this.sprintInput=t.isKeyPressed("Shift"))}gatherGamepadInput(){if(this.gamepadIndex===null)return;const t=navigator.getGamepads()[this.gamepadIndex];if(!t)return;const e=this.sanitzeGamepadAxis.bind(this);t.axes.length>=2&&(this.lookInput.x+=e(t.axes[0])*this.gamepadLookSensitivity,this.lookInput.y+=e(t.axes[1])*this.gamepadLookSensitivity),t.axes.length>=4&&(this.moveInput.x+=e(t.axes[2]),this.moveInput.y+=e(-t.axes[3])),this.jumpInput||(this.jumpInput=this.getGamepadButtons(t,[0,4,5,6])),this.sprintInput||(this.sprintInput=this.getGamepadButtons(t,[7,11]))}getGamepadButtons(t,e){let n=!1;return e.forEach(i=>{var r;n=n||((r=t.buttons[i])==null?void 0:r.pressed)||!1}),n}sanitzeGamepadAxis(t){return t==null?0:(t>=-this.gamepadDeadzone&&t<=this.gamepadDeadzone&&(t=0),t)}_onPointerMove(t){if(t instanceof MouseEvent){if(!st.IsLocked||this.isMobile||!this.enabled)return;this.handleLookNum(t.movementX,t.movementY)}}onGamepadConnected(t){t.gamepad.mapping=="standard"&&(this.gamepadIndex=t.gamepad.index)}onGamepadDisconnected(t){this.gamepadIndex==t.gamepad.index&&(this.gamepadIndex=null)}move(t){this.moveInput.copy(t)}jump(){this.jumpInput=!0}sprint(t){this.sprintInput=t}look(t){this.lookInput.copy(t)}handleLookVec(t){this.handleLookNum(t.x,t.y)}handleLookNum(t,e){var r;const n=-e/this.context.domHeight*this.lookSensitivity,i=-t/this.context.domWidth*this.lookSensitivity;this.x=yn.clamp(this.x+n,I.toRadians(this.xRotClamp.x),I.toRadians(this.xRotClamp.y)),this.y+=i,(r=this.yRotTarget)==null||r.setRotationFromAxisAngle(this.upVector,this.y),this.xRotTarget&&(this.xRotTarget.rotation.x=-this.x+Math.PI)}handleMove(t,e,n,i){if(!this.controller)return;const r=this.context.time.deltaTime;this.gameObject.getWorldDirection(this.fwdDir),this.rightDir.crossVectors(this.upDir,this.fwdDir),this.moveDir.set(0,0,0),this.moveDir.add(this.fwdDir.multiplyScalar(t.y)),this.moveDir.add(this.rightDir.multiplyScalar(-t.x)),this.moveDir.clampLength(0,1);const o=n?this.sprintSpeed:this.movementSpeed;this.moveDir.multiplyScalar(o*r);const a=this.controller.rigidbody;if(e&&this.controller.isGrounded){this.jumpVec.set(0,1,0),this.jumpVec.multiplyScalar(this.jumpSpeed);const j=a.getVelocity();j.y=0,a.setVelocity(j),a.applyImpulse(this.jumpVec),i==null||i()}a.applyImpulse(this.moveDir);const h=a.getVelocity(),c=h.y,m=n?this.maxSprintSpeed:this.maxSpeed;h.y=0,h.clampLength(0,m),h.y=c,a.setVelocity(h)}}M([l(Zs)],C.prototype,"controller",2);M([l(T)],C.prototype,"xRotTarget",2);M([l()],C.prototype,"lookSensitivity",2);M([l()],C.prototype,"movementSpeed",2);M([l()],C.prototype,"sprintSpeed",2);M([l()],C.prototype,"maxSpeed",2);M([l()],C.prototype,"maxSprintSpeed",2);M([l()],C.prototype,"jumpSpeed",2);M([l(R)],C.prototype,"xRotClamp",2);M([l()],C.prototype,"enableTouchInput",2);M([l()],C.prototype,"enableDesktopInput",2);M([l()],C.prototype,"enableGamepadInput",2);M([l()],C.prototype,"gamepadDeadzone",2);M([l()],C.prototype,"gamepadLookSensitivity",2);const Ht=(s,t)=>{const e=t.x-s.x,n=t.y-s.y;return Math.sqrt(e*e+n*n)},da=(s,t)=>{const e=t.x-s.x,n=t.y-s.y;return ua(Math.atan2(n,e))},ma=(s,t,e)=>{const n={x:0,y:0};return e=Fe(e),n.x=s.x-t*Math.cos(e),n.y=s.y-t*Math.sin(e),n},Fe=s=>s*(Math.PI/180),ua=s=>s*(180/Math.PI),fa=s=>isNaN(s.buttons)?s.pressure!==0:s.buttons!==0,Pe=new Map,Ci=s=>{Pe.has(s)&&clearTimeout(Pe.get(s)),Pe.set(s,setTimeout(s,100))},Qt=(s,t,e)=>{const n=t.split(/[ ,]+/g);let i;for(let r=0;r<n.length;r+=1)i=n[r],s.addEventListener?s.addEventListener(i,e,!1):s.attachEvent&&s.attachEvent(i,e)},Si=(s,t,e)=>{const n=t.split(/[ ,]+/g);let i;for(let r=0;r<n.length;r+=1)i=n[r],s.removeEventListener?s.removeEventListener(i,e):s.detachEvent&&s.detachEvent(i,e)},ys=s=>(s.preventDefault(),s.type.match(/^touch/)?s.changedTouches:s),Ii=()=>{const s=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:s,y:t}},Di=(s,t)=>{t.top||t.right||t.bottom||t.left?(s.style.top=t.top,s.style.right=t.right,s.style.bottom=t.bottom,s.style.left=t.left):(s.style.left=t.x+"px",s.style.top=t.y+"px")},mi=(s,t,e)=>{const n=xs(s);for(let i in n)if(n.hasOwnProperty(i))if(typeof t=="string")n[i]=t+" "+e;else{let r="";for(let o=0,a=t.length;o<a;o+=1)r+=t[o]+" "+e+", ";n[i]=r.slice(0,-2)}return n},ga=(s,t)=>{const e=xs(s);for(let n in e)e.hasOwnProperty(n)&&(e[n]=t);return e},xs=s=>{const t={};return t[s]="",["webkit","Moz","o"].forEach(function(n){t[n+s.charAt(0).toUpperCase()+s.slice(1)]=""}),t},Ce=(s,t)=>{for(let e in t)t.hasOwnProperty(e)&&(s[e]=t[e]);return s},ba=(s,t)=>{const e={};for(let n in s)s.hasOwnProperty(n)&&t.hasOwnProperty(n)?e[n]=t[n]:s.hasOwnProperty(n)&&(e[n]=s[n]);return e},Re=(s,t)=>{if(s.length)for(let e=0,n=s.length;e<n;e+=1)t(s[e]);else t(s)},va=(s,t,e)=>({x:Math.min(Math.max(s.x,t.x-e),t.x+e),y:Math.min(Math.max(s.y,t.y-e),t.y+e)});var ya="ontouchstart"in window,xa=!!window.PointerEvent,wa=!!window.MSPointerEvent,gt={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},nt,xt={};xa?nt=gt.pointer:wa?nt=gt.MSPointer:ya?(nt=gt.touch,xt=gt.mouse):nt=gt.mouse;function W(){}W.prototype.on=function(s,t){var e=this,n=s.split(/[ ,]+/g),i;e._handlers_=e._handlers_||{};for(var r=0;r<n.length;r+=1)i=n[r],e._handlers_[i]=e._handlers_[i]||[],e._handlers_[i].push(t);return e};W.prototype.off=function(s,t){var e=this;return e._handlers_=e._handlers_||{},s===void 0?e._handlers_={}:t===void 0?e._handlers_[s]=null:e._handlers_[s]&&e._handlers_[s].indexOf(t)>=0&&e._handlers_[s].splice(e._handlers_[s].indexOf(t),1),e};W.prototype.trigger=function(s,t){var e=this,n=s.split(/[ ,]+/g),i;e._handlers_=e._handlers_||{};for(var r=0;r<n.length;r+=1)i=n[r],e._handlers_[i]&&e._handlers_[i].length&&e._handlers_[i].forEach(function(o){o.call(e,{type:i,target:e},t)})};W.prototype.config=function(s){var t=this;t.options=t.defaults||{},s&&(t.options=ba(t.options,s))};W.prototype.bindEvt=function(s,t){var e=this;return e._domHandlers_=e._domHandlers_||{},e._domHandlers_[t]=function(){typeof e["on"+t]=="function"?e["on"+t].apply(e,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},Qt(s,nt[t],e._domHandlers_[t]),xt[t]&&Qt(s,xt[t],e._domHandlers_[t]),e};W.prototype.unbindEvt=function(s,t){var e=this;return e._domHandlers_=e._domHandlers_||{},Si(s,nt[t],e._domHandlers_[t]),xt[t]&&Si(s,xt[t],e._domHandlers_[t]),delete e._domHandlers_[t],this};function x(s,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=s,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=x.id,x.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}x.prototype=new W;x.constructor=x;x.id=0;x.prototype.buildEl=function(s){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};x.prototype.stylize=function(){if(this.options.dataOnly)return this;var s=this.options.fadeTime+"ms",t=ga("borderRadius","50%"),e=mi("transition","opacity",s),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},Ce(n.el,e),this.options.shape==="circle"&&Ce(n.back,t),Ce(n.front,t),this.applyStyles(n),this};x.prototype.applyStyles=function(s){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var e in s[t])this.ui[t].style[e]=s[t][e];return this};x.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};x.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};x.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};x.prototype.show=function(s){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof s=="function"&&s.call(this)},t.options.fadeTime)),t};x.prototype.hide=function(s){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var e=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=e,typeof s=="function"&&s.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){const e=t.options.restJoystick,n={};n.x=e===!0||e.x!==!1?0:t.instance.frontPosition.x,n.y=e===!0||e.y!==!1?0:t.instance.frontPosition.y,t.setPosition(s,n)}return t};x.prototype.setPosition=function(s,t){var e=this;e.frontPosition={x:t.x,y:t.y};var n=e.options.fadeTime+"ms",i={};i.front=mi("transition",["transform"],n);var r={front:{}};r.front={transform:"translate("+e.frontPosition.x+"px,"+e.frontPosition.y+"px)"},e.applyStyles(i),e.applyStyles(r),e.restTimeout=setTimeout(function(){typeof s=="function"&&s.call(e),e.restCallback()},e.options.fadeTime)};x.prototype.restCallback=function(){var s=this,t={};t.front=mi("transition","none",""),s.applyStyles(t),s.trigger("rested",s.instance)};x.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};x.prototype.computeDirection=function(s){var t=s.angle.radian,e=Math.PI/4,n=Math.PI/2,i,r,o;if(t>e&&t<e*3&&!s.lockX?i="up":t>-e&&t<=e&&!s.lockY?i="left":t>-e*3&&t<=-e&&!s.lockX?i="down":s.lockY||(i="right"),s.lockY||(t>-n&&t<n?r="left":r="right"),s.lockX||(t>0?o="up":o="down"),s.force>this.options.threshold){var a={},h;for(h in this.direction)this.direction.hasOwnProperty(h)&&(a[h]=this.direction[h]);var c={};this.direction={x:r,y:o,angle:i},s.direction=this.direction;for(h in a)a[h]===this.direction[h]&&(c[h]=!0);if(c.x&&c.y&&c.angle)return s;(!c.x||!c.y)&&this.trigger("plain",s),c.x||this.trigger("plain:"+r,s),c.y||this.trigger("plain:"+o,s),c.angle||this.trigger("dir dir:"+i,s)}else this.resetDirection();return s};function y(s,t){var e=this;e.nipples=[],e.idles=[],e.actives=[],e.ids=[],e.pressureIntervals={},e.manager=s,e.id=y.id,y.id+=1,e.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},e.config(t),(e.options.mode==="static"||e.options.mode==="semi")&&(e.options.multitouch=!1),e.options.multitouch||(e.options.maxNumberOfNipples=1);const n=getComputedStyle(e.options.zone.parentElement);return n&&n.display==="flex"&&(e.parentIsFlex=!0),e.updateBox(),e.prepareNipples(),e.bindings(),e.begin(),e.nipples}y.prototype=new W;y.constructor=y;y.id=0;y.prototype.prepareNipples=function(){var s=this,t=s.nipples;t.on=s.on.bind(s),t.off=s.off.bind(s),t.options=s.options,t.destroy=s.destroy.bind(s),t.ids=s.ids,t.id=s.id,t.processOnMove=s.processOnMove.bind(s),t.processOnEnd=s.processOnEnd.bind(s),t.get=function(e){if(e===void 0)return t[0];for(var n=0,i=t.length;n<i;n+=1)if(t[n].identifier===e)return t[n];return!1}};y.prototype.bindings=function(){var s=this;s.bindEvt(s.options.zone,"start"),s.options.zone.style.touchAction="none",s.options.zone.style.msTouchAction="none"};y.prototype.begin=function(){var s=this,t=s.options;if(t.mode==="static"){var e=s.createNipple(t.position,s.manager.getIdentifier());e.add(),s.idles.push(e)}};y.prototype.createNipple=function(s,t){var e=this,n=e.manager.scroll,i={},r=e.options,o={x:e.parentIsFlex?n.x:n.x+e.box.left,y:e.parentIsFlex?n.y:n.y+e.box.top};if(s.x&&s.y)i={x:s.x-o.x,y:s.y-o.y};else if(s.top||s.right||s.bottom||s.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=s.top,a.style.right=s.right,a.style.bottom=s.bottom,a.style.left=s.left,a.style.position="absolute",r.zone.appendChild(a);var h=a.getBoundingClientRect();r.zone.removeChild(a),i=s,s={x:h.left+n.x,y:h.top+n.y}}var c=new x(e,{color:r.color,size:r.size,threshold:r.threshold,fadeTime:r.fadeTime,dataOnly:r.dataOnly,restJoystick:r.restJoystick,restOpacity:r.restOpacity,mode:r.mode,identifier:t,position:s,zone:r.zone,frontPosition:{x:0,y:0},shape:r.shape});return r.dataOnly||(Di(c.ui.el,i),Di(c.ui.front,c.frontPosition)),e.nipples.push(c),e.trigger("added "+c.identifier+":added",c),e.manager.trigger("added "+c.identifier+":added",c),e.bindNipple(c),c};y.prototype.updateBox=function(){var s=this;s.box=s.options.zone.getBoundingClientRect()};y.prototype.bindNipple=function(s){var t=this,e,n=function(i,r){e=i.type+" "+r.id+":"+i.type,t.trigger(e,r)};s.on("destroyed",t.onDestroyed.bind(t)),s.on("shown hidden rested dir plain",n),s.on("dir:up dir:right dir:down dir:left",n),s.on("plain:up plain:right plain:down plain:left",n)};y.prototype.pressureFn=function(s,t,e){var n=this,i=0;clearInterval(n.pressureIntervals[e]),n.pressureIntervals[e]=setInterval(function(){var r=s.force||s.pressure||s.webkitForce||0;r!==i&&(t.trigger("pressure",r),n.trigger("pressure "+t.identifier+":pressure",r),i=r)}.bind(n),100)};y.prototype.onstart=function(s){var t=this,e=t.options,n=s;s=ys(s),t.updateBox();var i=function(r){t.actives.length<e.maxNumberOfNipples?t.processOnStart(r):n.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(o){if(Object.values(n.touches).findIndex(function(h){return h.identifier===o})<0){var a=[s[0]];a.identifier=o,t.processOnEnd(a)}}),t.actives.length<e.maxNumberOfNipples&&t.processOnStart(r))};return Re(s,i),t.manager.bindDocument(),!1};y.prototype.processOnStart=function(s){var t=this,e=t.options,n,i=t.manager.getIdentifier(s),r=s.force||s.pressure||s.webkitForce||0,o={x:s.pageX,y:s.pageY},a=t.getOrCreate(i,o);a.identifier!==i&&t.manager.removeIdentifier(a.identifier),a.identifier=i;var h=function(m){m.trigger("start",m),t.trigger("start "+m.id+":start",m),m.show(),r>0&&t.pressureFn(s,m,m.identifier),t.processOnMove(s)};if((n=t.idles.indexOf(a))>=0&&t.idles.splice(n,1),t.actives.push(a),t.ids.push(a.identifier),e.mode!=="semi")h(a);else{var c=Ht(o,a.position);if(c<=e.catchDistance)h(a);else{a.destroy(),t.processOnStart(s);return}}return a};y.prototype.getOrCreate=function(s,t){var e=this,n=e.options,i;return/(semi|static)/.test(n.mode)?(i=e.idles[0],i?(e.idles.splice(0,1),i):n.mode==="semi"?e.createNipple(t,s):(console.warn("Coudln't find the needed nipple."),!1)):(i=e.createNipple(t,s),i)};y.prototype.processOnMove=function(s){var t=this,e=t.options,n=t.manager.getIdentifier(s),i=t.nipples.get(n),r=t.manager.scroll;if(!fa(s)){this.processOnEnd(s);return}if(!i){console.error("Found zombie joystick with ID "+n),t.manager.removeIdentifier(n);return}if(e.dynamicPage){var o=i.el.getBoundingClientRect();i.position={x:r.x+o.left,y:r.y+o.top}}i.identifier=n;var a=i.options.size/2,h={x:s.pageX,y:s.pageY};e.lockX&&(h.y=i.position.y),e.lockY&&(h.x=i.position.x);var c=Ht(h,i.position),m=da(h,i.position),j=Fe(m),H=c/a,et={distance:c,position:h},zt,it;if(i.options.shape==="circle"?(zt=Math.min(c,a),it=ma(i.position,zt,m)):(it=va(h,i.position,a),zt=Ht(it,i.position)),e.follow){if(c>a){let Ss=h.x-it.x,Is=h.y-it.y;i.position.x+=Ss,i.position.y+=Is,i.el.style.top=i.position.y-(t.box.top+r.y)+"px",i.el.style.left=i.position.x-(t.box.left+r.x)+"px",c=Ht(h,i.position)}}else h=it,c=zt;var xe=h.x-i.position.x,we=h.y-i.position.y;i.frontPosition={x:xe,y:we},e.dataOnly||(i.ui.front.style.transform="translate("+xe+"px,"+we+"px)");var ut={identifier:i.identifier,position:h,force:H,pressure:s.force||s.pressure||s.webkitForce||0,distance:c,angle:{radian:j,degree:m},vector:{x:xe/a,y:-we/a},raw:et,instance:i,lockX:e.lockX,lockY:e.lockY};ut=i.computeDirection(ut),ut.angle={radian:Fe(180-m),degree:180-m},i.trigger("move",ut),t.trigger("move "+i.id+":move",ut)};y.prototype.processOnEnd=function(s){var t=this,e=t.options,n=t.manager.getIdentifier(s),i=t.nipples.get(n),r=t.manager.removeIdentifier(i.identifier);i&&(e.dataOnly||i.hide(function(){e.mode==="dynamic"&&(i.trigger("removed",i),t.trigger("removed "+i.id+":removed",i),t.manager.trigger("removed "+i.id+":removed",i),i.destroy())}),clearInterval(t.pressureIntervals[i.identifier]),i.resetDirection(),i.trigger("end",i),t.trigger("end "+i.id+":end",i),t.ids.indexOf(i.identifier)>=0&&t.ids.splice(t.ids.indexOf(i.identifier),1),t.actives.indexOf(i)>=0&&t.actives.splice(t.actives.indexOf(i),1),/(semi|static)/.test(e.mode)?t.idles.push(i):t.nipples.indexOf(i)>=0&&t.nipples.splice(t.nipples.indexOf(i),1),t.manager.unbindDocument(),/(semi|static)/.test(e.mode)&&(t.manager.ids[r.id]=r.identifier))};y.prototype.onDestroyed=function(s,t){var e=this;e.nipples.indexOf(t)>=0&&e.nipples.splice(e.nipples.indexOf(t),1),e.actives.indexOf(t)>=0&&e.actives.splice(e.actives.indexOf(t),1),e.idles.indexOf(t)>=0&&e.idles.splice(e.idles.indexOf(t),1),e.ids.indexOf(t.identifier)>=0&&e.ids.splice(e.ids.indexOf(t.identifier),1),e.manager.removeIdentifier(t.identifier),e.manager.unbindDocument()};y.prototype.destroy=function(){var s=this;s.unbindEvt(s.options.zone,"start"),s.nipples.forEach(function(e){e.destroy()});for(var t in s.pressureIntervals)s.pressureIntervals.hasOwnProperty(t)&&clearInterval(s.pressureIntervals[t]);s.trigger("destroyed",s.nipples),s.manager.unbindDocument(),s.off()};function _(s){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=Ii(),t.config(s),t.prepareCollections();var e=function(){var i;t.collections.forEach(function(r){r.forEach(function(o){i=o.el.getBoundingClientRect(),o.position={x:t.scroll.x+i.left,y:t.scroll.y+i.top}})})};Qt(window,"resize",function(){Ci(e)});var n=function(){t.scroll=Ii()};return Qt(window,"scroll",function(){Ci(n)}),t.collections}_.prototype=new W;_.constructor=_;_.prototype.prepareCollections=function(){var s=this;s.collections.create=s.create.bind(s),s.collections.on=s.on.bind(s),s.collections.off=s.off.bind(s),s.collections.destroy=s.destroy.bind(s),s.collections.get=function(t){var e;return s.collections.every(function(n){return e=n.get(t),!e}),e}};_.prototype.create=function(s){return this.createCollection(s)};_.prototype.createCollection=function(s){var t=this,e=new y(t,s);return t.bindCollection(e),t.collections.push(e),e};_.prototype.bindCollection=function(s){var t=this,e,n=function(i,r){e=i.type+" "+r.id+":"+i.type,t.trigger(e,r)};s.on("destroyed",t.onDestroyed.bind(t)),s.on("shown hidden rested dir plain",n),s.on("dir:up dir:right dir:down dir:left",n),s.on("plain:up plain:right plain:down plain:left",n)};_.prototype.bindDocument=function(){var s=this;s.binded||(s.bindEvt(document,"move").bindEvt(document,"end"),s.binded=!0)};_.prototype.unbindDocument=function(s){var t=this;(!Object.keys(t.ids).length||s===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};_.prototype.getIdentifier=function(s){var t;return s?(t=s.identifier===void 0?s.pointerId:s.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};_.prototype.removeIdentifier=function(s){var t={};for(var e in this.ids)if(this.ids[e]===s){t.id=e,t.identifier=this.ids[e],delete this.ids[e];break}return t};_.prototype.onmove=function(s){var t=this;return t.onAny("move",s),!1};_.prototype.onend=function(s){var t=this;return t.onAny("end",s),!1};_.prototype.oncancel=function(s){var t=this;return t.onAny("end",s),!1};_.prototype.onAny=function(s,t){var e=this,n,i="processOn"+s.charAt(0).toUpperCase()+s.slice(1);t=ys(t);var r=function(a,h,c){c.ids.indexOf(h)>=0&&(c[i](a),a._found_=!0)},o=function(a){n=e.getIdentifier(a),Re(e.collections,r.bind(null,a,n)),a._found_||e.removeIdentifier(n)};return Re(t,o),!1};_.prototype.destroy=function(){var s=this;s.unbindDocument(!0),s.ids={},s.index=0,s.collections.forEach(function(t){t.destroy()}),s.off()};_.prototype.onDestroyed=function(s,t){var e=this;if(e.collections.indexOf(t)<0)return!1;e.collections.splice(e.collections.indexOf(t),1)};const ji=new _,Ei={create:function(s){return ji.create(s)},factory:ji};var _a=Object.defineProperty,Oa=Object.getOwnPropertyDescriptor,$t=(s,t,e,n)=>{for(var i=n>1?void 0:n?Oa(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&_a(t,e,i),i};class tt extends d{constructor(){super(...arguments),this.onlyMobile=!0,this.movementSensitivity=1,this.lookSensitivity=5,this.maxDoubleTapDelay=200,this.onJump=new g,this.onMove=new g,this.onLook=new g,this._movementIsActive=!1,this._lookIsActive=!1,this._htmlElements=[]}awake(){this._lookVector=new R,this._movementVector=new R}onEnable(){if(!qe()&&this.onlyMobile)return;const t=document.createElement("div");t.id="look-joystick",t.style.cssText=`
                position: absolute;
                top: 0%;
                left: 0%;
                width: 100%;
                height: 100%;
                user-select: none;
                -webkit-user-select: none;
                -webkit-touch-callout: none;
            `;const e=document.createElement("div");e.id="movement-joystick",e.style.cssText=`
                position: absolute;
                bottom: 0;
                left: 0;
                width:  200px;
                height: 150px;
                user-select: none;
                -webkit-user-select: none;
                -webkit-touch-callout: none;
            `,this.context.domElement.append(t),this.context.domElement.append(e),this._htmlElements.push(t),this._htmlElements.push(e);const n=10;this._movement=Ei.create({mode:"static",position:{left:"50%",top:"0%"},catchDistance:1e3,zone:e,size:130,color:this.getRGBAColorString(this.moveJoyColor),fadeTime:0}),this._movement.on("start",()=>{this._movementIsActive=!0}),this._movement.on("move",(o,a)=>{a.distance>n?this._movementVector.set(a.vector.x,a.vector.y).multiplyScalar(this.movementSensitivity):this._movementVector.set(0,0)}),this._movement.on("end",()=>{this._movementIsActive=!1});const i=130/2;this._look=Ei.create({mode:"dynamic",catchDistance:1e3,maxNumberOfNipples:1,zone:t,size:130,color:this.getRGBAColorString(this.lookJoyColor),fadeTime:0}),this._look.on("start",()=>{this._lookIsActive=!0}),this._look.on("move",(o,a)=>{a.distance>n?this._lookVector.set(a.vector.x,a.vector.y*-1).multiplyScalar(this.lookSensitivity*a.distance/i):this._lookVector.set(0,0)});let r=0;this._look.on("end",()=>{var a;this._lookIsActive=!1;const o=Date.now();o-r<this.maxDoubleTapDelay&&((a=this.onJump)==null||a.invoke()),r=o})}onDisable(){var t,e;(t=this._movement)==null||t.destroy(),(e=this._look)==null||e.destroy();for(const n of this._htmlElements)n.remove();this._htmlElements.length=0}update(){var t,e;this._movementIsActive&&((t=this.onMove)==null||t.invoke(this._movementVector)),this._lookIsActive&&((e=this.onLook)==null||e.invoke(this._lookVector))}getRGBAColorString(t){return`rgba(${t.r*255}, ${t.g*255}, ${t.b*255}, ${t.a})`}}$t([l(Ri)],tt.prototype,"moveJoyColor",2);$t([l(Ri)],tt.prototype,"lookJoyColor",2);$t([l(g)],tt.prototype,"onJump",2);$t([l(g)],tt.prototype,"onMove",2);$t([l(g)],tt.prototype,"onLook",2);var Pa=Object.defineProperty,Ca=Object.getOwnPropertyDescriptor,de=(s,t,e,n)=>{for(var i=n>1?void 0:n?Ca(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Pa(t,e,i),i};const Sa=E("debugspawnhandler");class Lt extends d{constructor(){super(...arguments),this.spawnPoints=[],this.autoRespawn=!0,this.autoRespawnLimitY=-10,this.downVector=new u(0,-1,0)}async handlePlayerSpawn(t){await vt(1);const e=this.getRandomSpawnPoint();this.setPlayerToSpot(t,e),this.handlePlayerAutoRespawn(t);const n=t==null?void 0:t.getComponent(C);n&&this.mobileControls&&(this.mobileControls.onLook.addEventListener(i=>n.look(i)),this.mobileControls.onMove.addEventListener(i=>n.move(i)),this.mobileControls.onJump.addEventListener(()=>n.jump()))}getRandomSpawnPoint(){this.spawnPoints.sort(()=>Math.random()-.5);const t=new Ni;t.layerMask=new Ui,t.layerMask.enableAll(),t.ray=new Gi(new u,this.downVector.clone()),t.maxDistance=2;let e;for(let n=0;n<this.spawnPoints.length;n++){const i=this.spawnPoints[n];if(i.getWorldPosition(t.ray.origin),t.ray.origin.y+=3,t.ray.direction.copy(this.downVector),Sa&&L.DrawRay(t.ray.origin,t.ray.direction,16711680,50,!0),this.context.physics.raycast(t).length==0){e=i;break}}return e}setPlayerToSpot(t,e){var n;!t||!e||(t.worldPosition=e.worldPosition,t.worldQuaternion=e.worldQuaternion,(n=f.getComponent(t,C))==null||n.setCamRotationFromObject())}async handlePlayerAutoRespawn(t){for(;t;)if(await vt(5),t.worldPosition.y<this.autoRespawnLimitY){const n=this.getRandomSpawnPoint();this.setPlayerToSpot(t,n)}}}de([l(T)],Lt.prototype,"spawnPoints",2);de([l(tt)],Lt.prototype,"mobileControls",2);de([l()],Lt.prototype,"autoRespawn",2);de([l()],Lt.prototype,"autoRespawnLimitY",2);p.add("FirstPersonController",C);p.add("PointerLock",st);p.add("MobileControls",tt);p.add("SpawnHandler",Lt);var Ia=Object.defineProperty,Da=Object.getOwnPropertyDescriptor,ja=(s,t,e,n)=>{for(var i=n>1?void 0:n?Da(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Ia(t,e,i),i};const Ut=E("debugsyncanimator"),ws=class extends d{constructor(){super(...arguments),this.syncedAnimGuid=null,this.localParameters=[],this.currentController=null,this.isSyncAnim=!0,this.tempValues=[],this.modelRecieved=s=>{var n,i;if(!this.animator)return;Ut&&console.log(`${this.context.time.time.toFixed(2)} SyncAnimator incoming message`);for(let r=0;r<s.values.length;r++){const o=this.localParameters[r],a=s.values[r];var t=null;switch(o.type){case O.Trigger:case O.Bool:t=a==1;break;case O.Float:case O.Int:t=a||0;break}t!==o.value&&(Ut&&console.log(`Remote parameter: ${o.name} | ${o.value} --> ${t}`),o.value=t)}const e=s.state;if(e!==0){const r=(n=this.animator.runtimeAnimatorController)==null?void 0:n.findState(e);this.remoteState=r,Ut&&console.log(`${this.context.time.time.toFixed(2)} Remote state: ${(i=this.currentState)==null?void 0:i.name} --> ${r==null?void 0:r.name}`)}}}set SyncedAnimGuid(s){this.unregisterNetMessage(),this.syncedAnimGuid=s,this.registerNetMessage()}get SyncedAnimGuid(){return this.syncedAnimGuid}get currentState(){var s,t;return(t=(s=this.animator)==null?void 0:s.runtimeAnimatorController)==null?void 0:t.activeState}start(){this.SyncedAnimGuid??(this.SyncedAnimGuid=`${this.guid}`),this.enabled=this.localParameters!==void 0,this.enabled||console.warn("SyncAnimator has to be on an object with an Animator componenet")}onControllerChanged(){var s,t,e;this.animator=this.gameObject.getComponent(X),this.currentController=(s=this.animator)==null?void 0:s.runtimeAnimatorController,this.localParameters=(e=(t=this.currentController)==null?void 0:t.model)==null?void 0:e.parameters}registerNetMessage(){this.context.connection.beginListen(this.syncedAnimGuid,this.modelRecieved)}unregisterNetMessage(){this.context.connection.stopListen(this.syncedAnimGuid,this.modelRecieved)}onDestroy(){this.unregisterNetMessage()}onBeforeRender(){if(this.isSyncAnim!==void 0)return;const s=this.gameObject.getComponent(ws);!s||!s.enabled||(s.syncedAnimatorUpdate(),s.applyRemoteState(),s.dispatchChanges())}syncedAnimatorUpdate(){var s;this.currentController!==((s=this.animator)==null?void 0:s.runtimeAnimatorController)&&this.onControllerChanged()}applyRemoteState(){var s;this.remoteState&&this.remoteState!==this.currentState&&((s=this.animator.runtimeAnimatorController)==null||s.play(this.remoteState.hash),this.remoteState=null)}dispatchChanges(){!this.animator.parametersAreDirty&&!this.animator.isDirty||this.createAndSndModel(this.localParameters,this.animator.isDirty?this.currentState:void 0)}createAndSndModel(s,t){const e=this.context.connection;if(!e.isInRoom)return;this.tempValues.length=s.length;for(let r=0;r<s.length;r++){const o=s[r];var n=0;switch(o.type){case O.Trigger:case O.Bool:n=o.value?1:0;break;case O.Float:case O.Int:n=o.value;break}this.tempValues[r]=n}const i={guid:this.syncedAnimGuid,values:this.tempValues,state:(t==null?void 0:t.hash)||0};Ut&&console.log(`${this.context.time.time.toFixed(2)} SyncAnimator outgoing message`),e.send(this.guid,i)}};let me=ws;ja([Bs(X)],me.prototype,"onBeforeRender",1);var Ea=Object.defineProperty,Ta=Object.getOwnPropertyDescriptor,B=(s,t,e,n)=>{for(var i=n>1?void 0:n?Ta(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Ea(t,e,i),i};class mt extends d{constructor(){super(...arguments),this.animParam="",this.animParamToDisable=""}awake(){var e,n,i;const t=(i=(n=(e=this.animator)==null?void 0:e.runtimeAnimatorController)==null?void 0:n.model)==null?void 0:i.parameters;t&&(this.parameter=t.find(r=>r.name===this.animParam))}onPointerClick(t){var i,r,o;if(!this.animator||!this.syncAnimator||!this.parameter)return;const e=this.parameter.type;if(e==O.Float){var n=this.animator.getFloat(this.animParam)+.6;n>=1.7&&(n=0),this.animator.setFloat(this.animParam,n)}if((e==O.Bool||e==O.Trigger)&&this.animator.setBool(this.animParam,!this.parameter.value),this.animParamToDisable!=""){const a=(o=(r=(i=this.animator)==null?void 0:i.runtimeAnimatorController)==null?void 0:r.model)==null?void 0:o.parameters;if(!a)return;const h=a.find(c=>c.name===this.animParamToDisable);if(h){const c=h.type;c==O.Float||c==O.Int?this.animator.setFloat(this.animParamToDisable,0):(c==O.Bool||c==O.Trigger)&&this.animator.setBool(this.animParamToDisable,!1)}}}update(){if(this.parameter&&this.valueLabel){var t="";this.parameter.type==O.Float||this.parameter.type==O.Int?t=this.parameter.value.toFixed(1):t=`${this.parameter.value}`,this.valueLabel.text=t}}}B([l(X)],mt.prototype,"animator",2);B([l(me)],mt.prototype,"syncAnimator",2);B([l()],mt.prototype,"animParam",2);B([l()],mt.prototype,"animParamToDisable",2);B([l(D)],mt.prototype,"valueLabel",2);class ue extends d{constructor(){super(...arguments),this.animName=""}onPointerClick(t){this.animator&&this.syncAnimator&&this.animator.play(this.animName)}}B([l(X)],ue.prototype,"animator",2);B([l(me)],ue.prototype,"syncAnimator",2);B([l()],ue.prototype,"animName",2);const Se=2,F=4,V=4,_s=4,q=new Int32Array(2),Ti=new Float32Array(q.buffer),Mi=new Float64Array(q.buffer),Gt=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;class U{constructor(t,e){this.low=t|0,this.high=e|0}static create(t,e){return t==0&&e==0?U.ZERO:new U(t,e)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(t){return this.low==t.low&&this.high==t.high}}U.ZERO=new U(0,0);var Ne;(function(s){s[s.UTF8_BYTES=1]="UTF8_BYTES",s[s.UTF16_STRING=2]="UTF16_STRING"})(Ne||(Ne={}));class Zt{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new Zt(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new U(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new U(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return q[0]=this.readInt32(t),Ti[0]}readFloat64(t){return q[Gt?0:1]=this.readInt32(t),q[Gt?1:0]=this.readInt32(t+4),Mi[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){Ti[0]=e,this.writeInt32(t,q[0])}writeFloat64(t,e){Mi[0]=e,this.writeInt32(t,q[Gt?0:1]),this.writeInt32(t+4,q[Gt?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+F+V)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<V;e++)t+=String.fromCharCode(this.readInt8(this.position_+F+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);let i="",r=0;if(t+=F,e===Ne.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;r<n;){let o;const a=this.readUint8(t+r++);if(a<192)o=a;else{const h=this.readUint8(t+r++);if(a<224)o=(a&31)<<6|h&63;else{const c=this.readUint8(t+r++);if(a<240)o=(a&15)<<12|(h&63)<<6|c&63;else{const m=this.readUint8(t+r++);o=(a&7)<<18|(h&63)<<12|(c&63)<<6|m&63}}}o<65536?i+=String.fromCharCode(o):(o-=65536,i+=String.fromCharCode((o>>10)+55296,(o&1024-1)+56320))}return i}__union_with_string(t,e){return typeof t=="string"?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+F}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=V)throw new Error("FlatBuffers: file identifier must be length "+V);for(let e=0;e<V;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+F+e))return!1;return!0}createLong(t,e){return U.create(t,e)}createScalarList(t,e){const n=[];for(let i=0;i<e;++i)t(i)!==null&&n.push(t(i));return n}createObjList(t,e){const n=[];for(let i=0;i<e;++i){const r=t(i);r!==null&&n.push(r.unpack())}return n}}class ui{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let e;t?e=t:e=1024,this.bb=Zt.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=~(this.bb.capacity()-this.space+e)+1&t-1;for(;this.space<n+t+e;){const i=this.bb.capacity();this.bb=ui.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){(this.force_defaults||!e.equals(n))&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(e&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,i=Zt.allocate(n);return i.setPosition(n-e),i.bytes().set(t.bytes(),n-e),i}addOffset(t){this.prep(F,0),this.writeInt32(this.offset()-t+F)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&this.vtable[e]==0;e--);const n=e+1;for(;e>=0;e--)this.addInt16(this.vtable[e]!=0?t-this.vtable[e]:0);const i=2;this.addInt16(t-this.object_start);const r=(n+i)*Se;this.addInt16(r);let o=0;const a=this.space;t:for(e=0;e<this.vtables.length;e++){const h=this.bb.capacity()-this.vtables[e];if(r==this.bb.readInt16(h)){for(let c=Se;c<r;c+=Se)if(this.bb.readInt16(a+c)!=this.bb.readInt16(h+c))continue t;o=this.vtables[e];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const i=n?_s:0;if(e){const r=e;if(this.prep(this.minalign,F+V+i),r.length!=V)throw new Error("FlatBuffers: file identifier must be length "+V);for(let o=V-1;o>=0;o--)this.writeInt8(r.charCodeAt(o))}this.prep(this.minalign,F+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,i=n-this.bb.readInt32(n);if(!(this.bb.readInt16(i+e)!=0))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(F,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let n=0;for(;n<t.length;){let i;const r=t.charCodeAt(n++);if(r<55296||r>=56320)i=r;else{const o=t.charCodeAt(n++);i=(r<<10)+o+(65536-56623104-56320)}i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(i&63|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let n=0,i=this.space,r=this.bb.bytes();n<e.length;n++)r[i++]=e[n];return this.endVector()}createLong(t,e){return U.create(t,e)}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];if(i!==null)e.push(this.createObjectOffset(i));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}}class P{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSendBuffer_Model(t,e){return(e||new P).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSendBuffer_Model(t,e){return t.setPosition(t.position()+_s),(e||new P).__init(t.readInt32(t.position())+t.position(),t)}guid(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}guidLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}guidArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}dontSave(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}prefix(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}seconds(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt32(this.bb_pos+t):0}static startSendBuffer_Model(t){t.startObject(4)}static addGuid(t,e){t.addFieldOffset(0,e,0)}static createGuidVector(t,e){t.startVector(1,e.length,1);for(let n=e.length-1;n>=0;n--)t.addInt8(e[n]);return t.endVector()}static startGuidVector(t,e){t.startVector(1,e,1)}static addDontSave(t,e){t.addFieldInt8(1,+e,0)}static addPrefix(t,e){t.addFieldOffset(2,e,0)}static addSeconds(t,e){t.addFieldInt32(3,e,0)}static endSendBuffer_Model(t){return t.endObject()}static finishSendBuffer_ModelBuffer(t,e){t.finish(e)}static finishSizePrefixedSendBuffer_ModelBuffer(t,e){t.finish(e,void 0,!0)}static createSendBuffer_Model(t,e,n,i,r){return P.startSendBuffer_Model(t),P.addGuid(t,e),P.addDontSave(t,n),P.addPrefix(t,i),P.addSeconds(t,r),P.endSendBuffer_Model(t)}}var Os={exports:{}};(function(s,t){(function(e,n){s.exports=n()})(Xs,function(){return function(e){var n={};function i(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=n,i.d=function(r,o,a){i.o(r,o)||Object.defineProperty(r,o,{enumerable:!0,get:a})},i.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},i.t=function(r,o){if(1&o&&(r=i(r)),8&o||4&o&&typeof r=="object"&&r&&r.__esModule)return r;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:r}),2&o&&typeof r!="string")for(var h in r)i.d(a,h,function(c){return r[c]}.bind(null,h));return a},i.n=function(r){var o=r&&r.__esModule?function(){return r.default}:function(){return r};return i.d(o,"a",o),o},i.o=function(r,o){return Object.prototype.hasOwnProperty.call(r,o)},i.p="",i(i.s=0)}([function(e,n,i){i.r(n),i.d(n,"UuidTool",function(){return a}),i.d(n,"Uuid",function(){return o});var r={uuid:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i},o=function(){function h(c){this.id="",typeof c=="string"?this.fromString(c):Array.isArray(c)?this.fromBytes(c):this.generate()}return h.fromJson=function(c){if(typeof c=="string"&&(c=JSON.parse(c)),!c||!c.id)throw new TypeError("The input cannot be converted to Uuid.");return new h(c.id)},h.prototype.generate=function(){var c=new Array(16).fill(0).map(function(){return 256*Math.random()&255});return c[6]=79&(64|c[6]),this.fromBytes(c),this},h.prototype.fromBytes=function(c){return this.id=c.map(function(m){return("00"+m.toString(16)).slice(-2)}).join("").replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/,"$1-$2-$3-$4-$5"),this.id=this.toString(),this},h.prototype.toBytes=function(){return(this.id.replace(/-/g,"").match(/.{2}/g)||[]).map(function(c){return parseInt(c,16)})},h.prototype.fromString=function(c){return this.id=c.trim(),this.id=this.toString(),this},h.prototype.toString=function(){switch(h.stringExportFormat){default:case"lowercase":return this.id.toLowerCase();case"uppercase":return this.id.toUpperCase()}},h.prototype.isValid=function(){return typeof this.id=="string"&&this.id.length===36&&r.uuid.test(this.id)},h.prototype.equals=function(c){return typeof c=="string"&&(c=new h(c)),this.toString()===c.toString()},h.stringExportFormat="lowercase",h}(),a=function(){function h(){}return h.toBytes=function(c){return new o().fromString(c).toBytes()},h.toString=function(c){return new o().fromBytes(c).toString()},h.newUuid=function(){return new o().toString()},h.isUuid=function(c){return new o().fromString(c).isValid()},h.compare=function(c,m){return new o(c).equals(new o(m))},h}()}])})})(Os);var Ma=Os.exports,Aa=Object.defineProperty,$a=Object.getOwnPropertyDescriptor,fe=(s,t,e,n)=>{for(var i=n>1?void 0:n?$a(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Aa(t,e,i),i};const qt="MESG";Js(qt,P.getRootAsSendBuffer_Model);class Ft extends d{constructor(){super(...arguments),this.saveState=!0,this.recieveBuffer=t=>{this.msgLabel&&(this.msgLabel.text=`${t.prefix()} ${t.seconds()}`)}}onEnable(){this.context.connection.beginListenBinary(qt,this.recieveBuffer)}onDisable(){this.context.connection.stopListenBinary(qt,this.recieveBuffer)}sendBuffer(){const t=new ui(0),e=P.createGuidVector(t,Ma.UuidTool.toBytes(this.guid)),n=!this.saveState,i=t.createString("Hello, it is "),r=Math.floor(this.context.time.time);console.log(e),P.startSendBuffer_Model(t),P.addGuid(t,e),P.addDontSave(t,n),P.addPrefix(t,i),P.addSeconds(t,r);const o=P.endSendBuffer_Model(t);t.finish(o,qt);const a=t.asUint8Array();this.context.connection.sendBinary(a),this.outgoingSizeLabel&&(this.outgoingSizeLabel.text=`${a.length} bytes`)}deleteState(){this.context.connection.sendDeleteRemoteState(this.guid)}awake(){this.updateSaveStateLabel()}toggleSaveState(){this.saveState=!this.saveState,this.updateSaveStateLabel()}updateSaveStateLabel(){this.saveStateLabel&&(this.saveStateLabel.text=`Save state: ${this.saveState}`)}}fe([l(D)],Ft.prototype,"msgLabel",2);fe([l(D)],Ft.prototype,"saveStateLabel",2);fe([l(D)],Ft.prototype,"outgoingSizeLabel",2);fe([l()],Ft.prototype,"saveState",2);var La=Object.defineProperty,Fa=Object.getOwnPropertyDescriptor,ge=(s,t,e,n)=>{for(var i=n>1?void 0:n?Fa(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&La(t,e,i),i};class Rt extends d{constructor(){super(...arguments),this.saveState=!0,this.msgId="SendMessage",this.recieveMessage=t=>{this.msgLabel&&(this.msgLabel.text=`${t.prefix} ${t.seconds}`)}}onEnable(){this.context.connection.beginListen(this.msgId,this.recieveMessage)}onDisable(){this.context.connection.stopListen(this.msgId,this.recieveMessage)}sendMessage(){const t={guid:this.guid,dontSave:!this.saveState,prefix:"Hello, it is ",seconds:Math.floor(this.context.time.time)};if(this.context.connection.send(this.msgId,t),this.outgoingSizeLabel){const e=new TextEncoder().encode(JSON.stringify(t));this.outgoingSizeLabel.text=`${e.length} bytes`}}deleteState(){this.context.connection.sendDeleteRemoteState(this.guid)}awake(){this.updateSaveStateLabel()}toggleSaveState(){this.saveState=!this.saveState,this.updateSaveStateLabel()}updateSaveStateLabel(){this.saveStateLabel&&(this.saveStateLabel.text=`Save state: ${this.saveState}`)}}ge([l(D)],Rt.prototype,"msgLabel",2);ge([l(D)],Rt.prototype,"saveStateLabel",2);ge([l(D)],Rt.prototype,"outgoingSizeLabel",2);ge([l()],Rt.prototype,"saveState",2);var Ra=Object.defineProperty,Na=Object.getOwnPropertyDescriptor,za=(s,t,e,n)=>{for(var i=n>1?void 0:n?Na(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Ra(t,e,i),i};const Ie="EventListOnClick";class Ps extends d{constructor(){super(...arguments),this.model={id:""},this.onRemoteClick=t=>{var e;t.id===this.guid&&((e=this.onClicked)==null||e.invoke())}}onEnable(){this.context.connection.beginListen(Ie,this.onRemoteClick)}onDisable(){this.context.connection.stopListen(Ie,this.onRemoteClick)}onPointerClick(t){var e;(e=this.onClicked)==null||e.invoke(),this.model.id=this.guid,this.context.connection.send(Ie,this.model)}}za([l(g)],Ps.prototype,"onClicked",2);var Va=Object.defineProperty,Ua=Object.getOwnPropertyDescriptor,Ga=(s,t,e,n)=>{for(var i=n>1?void 0:n?Ua(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Va(t,e,i),i};class Cs extends d{constructor(){super(...arguments),this.updateLabel=()=>{this.label&&this.playerState&&(this.label.text=`${this.playerState.owner}
${this.playerState.isLocalPlayer?"<color=#ff715e>Local</color>":"Remote"}`)}}start(){this.playerState=this.gameObject.getComponentInParent(Ye),this.playerState&&(this.playerState.hasOwner?this.updateLabel():this.playerState.onFirstOwnerChangeEvent.addEventListener(this.updateLabel))}}Ga([l(D)],Cs.prototype,"label",2);var ka=Object.defineProperty,Wa=Object.getOwnPropertyDescriptor,be=(s,t,e,n)=>{for(var i=n>1?void 0:n?Wa(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&ka(t,e,i),i};class Nt extends d{constructor(){super(...arguments),this.speed=5,this.currentGoal=new u,this.pointerPos=new R,this.tempVec1=new u,this.tempVec2=new u,this.initialize=()=>{var n;if(!this.playerState||!this.mainRenderer)return;this.syncedTransform&&((n=this.playerState)!=null&&n.isLocalPlayer)&&this.syncedTransform.requestOwnership();const t=this.playerState.owner??"",e=this.mainRenderer.sharedMaterial;if(e){const i=new Ke;i.copy(e);const r=parseInt(t,16);i.color=new yt(r),this.mainRenderer.sharedMaterial=i}}}start(){this.playerState&&(this.playerState.hasOwner?this.initialize():this.playerState.onFirstOwnerChangeEvent.addEventListener(this.initialize),this.currentGoal.copy(this.gameObject.position))}update(){var t;if((t=this.playerState)!=null&&t.isLocalPlayer){const e=this.context.input,n=this.context.mainCamera,i=this.context.time.deltaTime,r=this.context.physics.engine;this.tempVec1.copy(this.currentGoal),this.tempVec2.copy(this.gameObject.position);const o=this.tempVec1.sub(this.tempVec2),a=this.speed*i;o.length()<a?this.gameObject.position.copy(this.currentGoal):this.gameObject.translateOnAxis(o.normalize(),a);const h=!1;if(e.getPointerDown(0)){const c=e.getPointerPosition(0);c&&this.pointerPos.copy(c)}if(e.getPointerUp(0)&&n&&((e.getPointerPosition(0)||new R).distanceTo(this.pointerPos)<40||h)){const m=r.raycast();m&&m.collider&&this.currentGoal.copy(m.point)}}}}be([l(Ye)],Nt.prototype,"playerState",2);be([l(Fi)],Nt.prototype,"syncedTransform",2);be([l($)],Nt.prototype,"mainRenderer",2);be([l()],Nt.prototype,"speed",2);var Ha=Object.defineProperty,qa=Object.getOwnPropertyDescriptor,fi=(s,t,e,n)=>{for(var i=n>1?void 0:n?qa(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Ha(t,e,i),i};const Ya=E("debugspawnhandler");class ve extends d{constructor(){super(...arguments),this.spawnPoints=[],this.validIndex=-1,this.offsetForError=1,this.downVector=new u(0,-1,0),this.upVector=new u(0,1,0),this.offsetVector=new u}handlePlayerSpawn(t){const e=new Ni;e.layerMask=new Ui,e.layerMask.enableAll(),e.ray=new Gi(new u,this.downVector.clone()),e.maxDistance=2;let n;this.validIndex+1>=this.spawnPoints.length?this.validIndex=0:this.validIndex++;for(let o=this.validIndex;o<this.spawnPoints.length;o++){const a=this.spawnPoints[o];if(a.getWorldPosition(e.ray.origin),e.ray.origin.y+=3,e.ray.direction.copy(this.downVector),Ya&&L.DrawLine(e.ray.origin,e.ray.origin.clone().add(e.ray.direction.clone().multiplyScalar(e.maxDistance)),16711680,50,!0),this.context.physics.raycast(e).length==0){n=a,this.validIndex=o;break}}n||console.log("No available spawn");const i=(n==null?void 0:n.position.clone())||new u,r=(n==null?void 0:n.rotation.clone())||new xn;this.offsetVector.set(0,0,this.offsetForError),this.offsetVector.applyAxisAngle(this.upVector,Math.random()*Math.PI*2),i.add(this.offsetVector),t instanceof T&&(t.worldToLocal(i),t.position.copy(i),t.rotation.copy(r))}}fi([l(T)],ve.prototype,"spawnPoints",2);fi([Q()],ve.prototype,"validIndex",2);fi([l()],ve.prototype,"offsetForError",2);var Ka=Object.defineProperty,Qa=Object.getOwnPropertyDescriptor,gi=(s,t,e,n)=>{for(var i=n>1?void 0:n?Qa(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Ka(t,e,i),i};class wt extends d{constructor(){super(...arguments),this.model=new Za}awake(){this.onModelChanged()}updateUser(){var e;this.model.guid=this.guid;let t=this.model.users.find(n=>n.userId==this.context.connection.connectionId);t||(t=new Ba,this.model.users.push(t)),t.userId=this.context.connection.connectionId,t.nickname=(e=this.inputField)==null?void 0:e.text,this.model=this.model}onModelChanged(){if(b("Room data recieved"),this.displayLabel){const t=this.model.users.map(e=>`${e.nickname}`).join(`
`);this.displayLabel.text=t.length>0?t:"no data"}}}gi([Q(wt.prototype.onModelChanged)],wt.prototype,"model",2);gi([l(D)],wt.prototype,"displayLabel",2);gi([l(zi)],wt.prototype,"inputField",2);class Za{constructor(){this.guid="",this.users=[]}}class Ba{constructor(){this.userId="",this.nickname=""}}var Xa=Object.defineProperty,Ja=Object.getOwnPropertyDescriptor,bi=(s,t,e,n)=>{for(var i=n>1?void 0:n?Ja(t,e):t,r=s.length-1,o;r>=0;r--)(o=s[r])&&(i=(n?o(t,e,i):o(i))||i);return n&&i&&Xa(t,e,i),i};class ye extends d{update(){var a;if((a=this.gameObject.getComponent(N))==null||a.lockPositionX,!this.roomLabel||!this.usersLabel)return;const t=this.context.connection,e=t.currentRoomName||"",n=t.connectionId||"",i=t.currentRoomViewId||"";this.roomLabel.text=t.isInRoom?`Joined:
${e}
(${n}) (${i})
${t.currentLatency.toFixed(2)}ms`:"Not in a room";const r=t.usersInRoom().join(`
`),o=r.length>0?r:"no users";this.usersLabel.text=t.isInRoom?o:""}joinRoom(){const t=this.context.connection;this.roomNameInput&&(t.isInRoom?b("You are already in a room, you have to leave it first!",He.Warn):t.joinRoom(this.roomNameInput.text))}disconnectRoom(){const t=this.context.connection;t.isInRoom&&t.leaveRoom()}}bi([l(D)],ye.prototype,"roomLabel",2);bi([l(D)],ye.prototype,"usersLabel",2);bi([l(zi)],ye.prototype,"roomNameInput",2);p.add("SyncedAnimator",me);p.add("SyncedAnimatorControls_RandomValue",mt);p.add("SyncedAnimatorControls_PlayAnim",ue);p.add("SendBufferExample",Ft);p.add("SendMessageExample",Rt);p.add("TriggerEventListOnClick",Ps);p.add("PlayerStateUI",Cs);p.add("SampleNetworkedPlayer",Nt);p.add("SpawnSpotHandler",ve);p.add("RoomData",wt);p.add("RoomManager",ye);
